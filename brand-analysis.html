<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç¡•èŠ½GEOå“ç‰Œåˆ†æå¹³å° - èŠ±è¥¿å­æ¡ˆä¾‹</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-primary: #f8f9fb;
      --bg-secondary: #ffffff;
      --text-primary: #111827;
      --text-secondary: #4b5563;
      --accent-dark: #111827;
      --accent-gold: #d4af37;
      --accent-blue: #2563eb;
      --card-border: rgba(17, 24, 39, 0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Roboto', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      letter-spacing: 0.2px;
    }

    h1, h2, h3, h4 { margin: 0; font-weight: 600; }

    .tech-shell {
      min-height: 100vh;
      padding: 56px 40px 80px;
      background: linear-gradient(145deg, rgba(17, 24, 39, 0.05) 0%, rgba(248, 249, 251, 0.95) 55%, rgba(212, 175, 55, 0.18) 100%);
    }

    .page-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 32px;
      letter-spacing: 1.5px;
      color: var(--accent-dark);
      margin-bottom: 8px;
    }

    .page-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
      margin-bottom: 28px;
    }

    .glass-card {
      background: var(--bg-secondary);
      border-radius: 18px;
      border: 1px solid var(--card-border);
      padding: 26px;
      margin-bottom: 24px;
      box-shadow: 0 14px 28px -24px rgba(17, 24, 39, 0.25);
    }

    .section-title {
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 18px;
    }

    .section-title::before {
      content: "";
      width: 48px;
      height: 2px;
      background: linear-gradient(90deg, var(--accent-gold), transparent);
    }

    .form-section { display: grid; gap: 18px; }

    .form-section-body { display: grid; gap: 14px; }

    .form-insight-grid {
      display: grid;
      gap: 20px;
      grid-template-columns: minmax(360px, 1fr) minmax(260px, 320px);
      align-items: start;
    }

    .analysis-insight-column { display: grid; gap: 12px; }

    .deep-direction-card {
      border: none;
      border-radius: 16px;
    }

    .form-row {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(3, minmax(220px, 1fr));
    }

    .form-field { display: grid; gap: 6px; }

    .form-field textarea,
    .form-field input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(17, 24, 39, 0.12);
      font-size: 13px;
      color: var(--text-primary);
      background: rgba(255, 255, 255, 0.98);
    }

    .form-field textarea { min-height: 96px; resize: vertical; }

    .form-label {
      font-size: 13px;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .field-required { color: #b91c1c; font-weight: 600; }

    .field-ai {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(17, 24, 39, 0.06);
      color: var(--accent-dark);
      font-size: 11px;
    }

    .form-value {
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px dashed rgba(17, 24, 39, 0.12);
      background: rgba(17, 24, 39, 0.02);
      font-size: 13px;
      color: var(--text-primary);
      line-height: 1.7;
    }

    .step-actions { display: flex; gap: 12px; flex-wrap: wrap; }

    .step-btn {
      padding: 10px 18px;
      border-radius: 12px;
      border: 1px solid rgba(17, 24, 39, 0.16);
      background: rgba(17, 24, 39, 0.04);
      color: var(--accent-dark);
      font-size: 13px;
      cursor: pointer;
    }

    .step-btn.primary {
      border: none;
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95), rgba(212, 175, 55, 0.58));
      color: #fff;
    }

    .action-btn {
      padding: 10px 20px;
      border-radius: 12px;
      border: 1px solid rgba(17, 24, 39, 0.12);
      background: rgba(17, 24, 39, 0.04);
      color: var(--accent-dark);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .action-btn.primary {
      border: none;
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95), rgba(212, 175, 55, 0.58));
      color: #fff;
    }

    .action-btn.outline {
      background: #ffffff;
      color: var(--accent-dark);
    }

    .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px -14px rgba(17, 24, 39, 0.6);
    }

    .subheading {
      font-size: 13px;
      color: var(--accent-dark);
      margin: 12px 0 8px;
      font-weight: 600;
    }

    .methodology-line {
      display: flex;
      gap: 10px;
      align-items: center;
      font-size: 12.5px;
      color: var(--text-secondary);
      margin: 8px 0 16px;
    }

    .deep-analysis-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin: 36px 0 18px;
    }

    .analysis-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin-bottom: 28px;
      flex-wrap: wrap;
    }

    .tab-group { display: flex; gap: 12px; }

    .tab-btn {
      padding: 10px 18px;
      border-radius: 999px;
      border: 1px solid var(--card-border);
      background: rgba(17, 24, 39, 0.04);
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 13px;
    }

    .tab-btn.active { background: rgba(17, 24, 39, 0.92); color: #fff; }

    .filter-chip-row { display: flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; }

    .filter-chip {
      padding: 8px 16px;
      border-radius: 18px;
      border: 1px solid rgba(17, 24, 39, 0.12);
      background: rgba(17, 24, 39, 0.04);
      color: var(--text-secondary);
      font-size: 12px;
      cursor: pointer;
    }

    .filter-chip.active { background: rgba(17, 24, 39, 0.9); color: #fff; border-color: transparent; }

    .health-grid {
      display: grid;
      grid-template-columns: minmax(420px, 1fr) 360px;
      gap: 20px;
      align-items: stretch;
    }

    .health-left {
      border-radius: 14px;
      padding: 18px;
      background: rgba(255, 255, 255, 0.96);
      display: grid;
      gap: 18px;
    }

    .health-left p { font-size: 13.5px; color: var(--text-secondary); margin: 0; line-height: 1.8; }

    .health-metrics { display: grid; gap: 12px; grid-template-columns: repeat(4, minmax(150px, 1fr)); }

    .metric-card {
      border: 1px solid rgba(226, 232, 240, 0.9);
      border-radius: 12px;
      padding: 12px 14px;
      background: rgba(255, 255, 255, 0.96);
      display: grid;
      gap: 6px;
      min-height: 108px;
    }

    .health-right {
      border: none;
      border-radius: 16px;
      background: #ffffff;
      padding: 16px;
      display: grid;
      gap: 12px;
    }

    .chart-container { width: 100%; height: 300px; }

    .radar-legend { text-align: center; font-size: 12px; color: var(--text-secondary); }

    .keyword-cloud-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 18px;
      align-items: stretch;
      margin-bottom: 20px;
    }

    .keyword-design-card,
    .question-cloud,
    .question-card {
      border: 1px solid var(--card-border);
      border-radius: 14px;
      background: #ffffff;
      padding: 14px;
      display: grid;
      gap: 10px;
    }

    .keyword-line {
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 12.5px;
      color: var(--text-secondary);
    }

    .keyword-line + .keyword-line {
      margin-top: 4px;
    }

    .keyword-label {
      font-weight: 600;
      color: var(--accent-dark);
    }

    .keyword-value {
      display: block;
    }

    @media (min-width: 768px) {
      .keyword-line {
        flex-direction: row;
        align-items: baseline;
      }

      .keyword-value {
        margin-left: 6px;
      }
    }

    .analysis-badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(212, 175, 55, 0.16);
      color: #735610;
      font-size: 11px;
      font-weight: 600;
    }

    .question-row {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      align-items: stretch;
      margin-bottom: 18px;
    }

    .question-row:last-of-type {
      margin-bottom: 0;
    }

    .question-row.full-width {
      grid-template-columns: 1fr;
    }

    .question-row.social-row {
      grid-template-columns: repeat(3, minmax(220px, 1fr));
    }

    @media (max-width: 960px) {
      .question-row.social-row {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
    }

    .content-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      align-items: stretch;
    }

    .content-card {
      border: 1px solid var(--card-border);
      border-radius: 14px;
      background: #ffffff;
      padding: 16px;
      display: grid;
      gap: 10px;
    }

    .content-card header {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      color: var(--accent-dark);
      font-weight: 600;
    }

    .content-item {
      display: grid;
      gap: 6px;
    }

    .content-meta {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .content-bar {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: rgba(148, 163, 184, 0.2);
      overflow: hidden;
    }

    .content-bar span {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, rgba(17, 24, 39, 0.85), rgba(212, 175, 55, 0.45));
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12.5px;
    }

    .data-table th,
    .data-table td {
      padding: 12px 14px;
      border-bottom: 1px solid rgba(17, 24, 39, 0.08);
      text-align: left;
      color: var(--text-secondary);
    }

    .data-table th {
      background: rgba(17, 24, 39, 0.04);
      color: var(--accent-dark);
      font-weight: 600;
    }

    .keyword-design-card h4,
    .question-card h4 { font-size: 13px; color: var(--text-primary); }

    .question-card ul { margin: 0; font-size: 12.5px; color: var(--text-secondary); line-height: 1.7; list-style: none; padding-left: 0; }
    .question-card ul { display: grid; gap: 8px; }
    .question-card ul li { display: flex; justify-content: space-between; align-items: center; gap: 12px; padding-bottom: 6px; border-bottom: 1px solid rgba(17, 24, 39, 0.06); }
    .question-card ul li:last-child { border-bottom: none; padding-bottom: 0; }
    .question-card ul li a {
      flex: 1;
      color: var(--accent-dark);
      text-decoration: none;
      transition: color 0.2s ease;
    }
    .question-card ul li a:hover { color: rgba(17, 24, 39, 0.72); }
    .question-card ul li span:first-child { flex: 1; color: var(--text-secondary); }

    .question-group-title { font-size: 12.5px; color: var(--accent-dark); font-weight: 600; }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      border-radius: 999px;
      background: rgba(212, 175, 55, 0.18);
      color: #735610;
      font-size: 11px;
      font-weight: 600;
    }

    .strategy-table-wrapper {
      border-radius: 16px;
      background: #ffffff;
      padding: 0;
      display: grid;
      gap: 18px;
    }

    .strategy-summary-inline {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 0 16px;
      font-size: 12.5px;
      color: var(--text-secondary);
      flex-wrap: wrap;
    }

    .strategy-flow {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 18px;
    }

    .strategy-node {
      border: 1px solid rgba(17, 24, 39, 0.08);
      border-radius: 16px;
      background: #ffffff;
      padding: 16px;
      display: grid;
      gap: 12px;
    }

    .strategy-node-header {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .strategy-step {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: rgba(17, 24, 39, 0.08);
      color: var(--accent-dark);
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .strategy-risk {
      font-size: 13px;
      font-weight: 600;
      color: var(--accent-dark);
    }

    .strategy-risk.high { color: #991b1b; }
    .strategy-risk.medium { color: #854d0e; }
    .strategy-risk.low { color: #166534; }

    .strategy-node-body {
      display: grid;
      gap: 12px;
    }

    .strategy-node-section {
      display: grid;
      gap: 8px;
    }

    .strategy-node-label {
      font-size: 12px;
      color: var(--accent-dark);
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .strategy-node-section ul {
      margin: 0;
      padding-left: 18px;
      display: grid;
      gap: 4px;
      font-size: 12.5px;
      color: var(--text-secondary);
    }

    .strategy-node-foot {
      font-size: 12.5px;
      color: var(--accent-dark);
      font-weight: 500;
      margin-top: 4px;
    }

    .strategy-summary {
      display: none;
    }

    @media (max-width: 1200px) {
      .health-metrics { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
    }

    @media (max-width: 960px) {
      .health-grid { grid-template-columns: 1fr; }
      .form-row { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
      .form-insight-grid { grid-template-columns: 1fr; }
    }

    .tab-section { display: grid; gap: 24px; }

    .section-grid { display: grid; gap: 20px; }

    .overview-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .overview-card {
      border: 1px solid var(--card-border);
      border-radius: 16px;
      background: #fff;
      padding: 16px;
      display: grid;
      gap: 10px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .overview-card.primary {
      border-color: rgba(212, 175, 55, 0.7);
      box-shadow: 0 12px 24px -20px rgba(212, 175, 55, 0.55);
    }

    .overview-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .brand-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--accent-dark);
      font-weight: 600;
    }

    .brand-tag .badge { background: rgba(17, 24, 39, 0.85); color: #fff; }

    .brand-meta { font-size: 12px; color: var(--text-secondary); line-height: 1.7; }

    .brand-meta strong { color: var(--accent-dark); }

    .brand-logo {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      background: #f8f9fb;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .brand-logo img { width: 100%; height: 100%; object-fit: cover; }
    .brand-logo span { font-size: 12px; color: var(--accent-dark); font-weight: 600; }

    .model-card {
      display: grid;
      gap: 12px;
    }

    .model-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .model-logo {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: rgba(17, 24, 39, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      flex-shrink: 0;
    }

    .model-logo img { width: 100%; height: 100%; object-fit: cover; }
    .model-logo span { font-size: 11px; color: var(--accent-dark); font-weight: 600; }

    .model-info-row {
      display: flex;
      justify-content: space-between;
      font-size: 12.5px;
      color: var(--text-secondary);
    }

    .model-info-row strong { color: var(--text-primary); }

    .analysis-flow {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
      gap: 12px;
      align-items: stretch;
      margin-top: 8px;
    }

    .analysis-flow-item {
      position: relative;
      border: 1px solid rgba(17, 24, 39, 0.12);
      border-radius: 14px;
      padding: 14px 16px;
      background: linear-gradient(135deg, rgba(255,255,255,0.98), rgba(248,249,251,0.94));
      display: grid;
      gap: 6px;
    }

    .analysis-flow-item::after {
      content: '';
      position: absolute;
      top: 50%;
      right: -10px;
      width: 20px;
      height: 2px;
      background: linear-gradient(90deg, rgba(17, 24, 39, 0.45), rgba(212, 175, 55, 0.65));
      transform: translateY(-50%);
      display: none;
    }

    .analysis-flow-item:not(:last-child)::after {
      display: block;
    }

    @media (max-width: 960px) {
      .analysis-flow {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }

      .analysis-flow-item::after {
        display: none !important;
      }
    }

    .analysis-flow-item strong { font-size: 13.2px; letter-spacing: 0.4px; }
    .analysis-flow-item span { color: var(--text-secondary); }

    .core-grid {
      display: grid;
      grid-template-columns: minmax(280px, 1fr) minmax(320px, 380px);
      gap: 24px;
      align-items: stretch;
    }

    .core-summary { display: grid; gap: 16px; }

    .core-summary p { margin: 0; font-size: 13px; color: var(--text-secondary); }

    .summary-highlight { font-weight: 600; color: var(--accent-dark); }

    .heatmap-table td strong { display: inline-block; margin-bottom: 4px; color: var(--accent-dark); }

    .score-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(17, 24, 39, 0.06);
      color: var(--accent-dark);
    }

    .score-badge.good { background: rgba(34, 197, 94, 0.12); color: #166534; }
    .score-badge.warn { background: rgba(234, 179, 8, 0.16); color: #854d0e; }
    .score-badge.risk { background: rgba(220, 38, 38, 0.15); color: #991b1b; }

    .insight-board {
      display: grid;
      grid-template-columns: minmax(280px, 1fr) minmax(300px, 1fr);
      gap: 18px;
    }

    .insight-block { border: 1px solid rgba(17, 24, 39, 0.08); border-radius: 16px; padding: 18px; background: #fff; display: grid; gap: 12px; }

    .insight-block h4 { margin: 0; font-size: 14px; color: var(--accent-dark); }

    .insight-list { margin: 0; padding-left: 18px; font-size: 12.5px; color: var(--text-secondary); line-height: 1.7; }

    .media-grid { display: grid; gap: 20px; }

    .media-dual { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; }

    .media-table { width: 100%; border-collapse: collapse; font-size: 12.5px; }
    .media-table th, .media-table td { padding: 12px 14px; border-bottom: 1px solid rgba(17, 24, 39, 0.08); text-align: left; }
    .media-table th { background: rgba(17, 24, 39, 0.04); color: var(--accent-dark); }

    .content-metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; }
    .content-metric-card { border: 1px solid var(--card-border); border-radius: 14px; background: #fff; padding: 14px; display: grid; gap: 6px; }
    .content-metric-card strong { font-size: 14px; color: var(--accent-dark); }
    .content-metric-card span { font-size: 12.5px; color: var(--text-secondary); }

    .timeline-wrapper { display: grid; gap: 12px; }
    .timeline-row { display: grid; gap: 6px; }
    .timeline-meta { display: flex; justify-content: space-between; font-size: 12.5px; color: var(--accent-dark); }
    .timeline-bar { position: relative; height: 12px; border-radius: 6px; background: rgba(17, 24, 39, 0.08); overflow: hidden; }
    .timeline-bar span { position: absolute; top: 0; left: 0; bottom: 0; border-radius: 6px; background: linear-gradient(90deg, rgba(17, 24, 39, 0.9), rgba(212, 175, 55, 0.55)); }

    .platform-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
    .platform-card { border: 1px solid var(--card-border); border-radius: 16px; background: #fff; padding: 16px; display: grid; gap: 8px; }
    .platform-card h4 { margin: 0; font-size: 14px; color: var(--accent-dark); }
    .platform-card ul { margin: 0; padding-left: 16px; font-size: 12.5px; color: var(--text-secondary); line-height: 1.6; }

    .guideline-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; }
    .guideline-card { border: 1px solid rgba(17, 24, 39, 0.08); border-radius: 14px; background: #fff; padding: 16px; display: grid; gap: 8px; }
    .guideline-card h4 { margin: 0; font-size: 14px; color: var(--accent-dark); }
    .guideline-card ul { margin: 0; padding-left: 18px; font-size: 12.5px; color: var(--text-secondary); line-height: 1.6; }

    @media (max-width: 1080px) {
      .core-grid { grid-template-columns: 1fr; }
      .insight-board { grid-template-columns: 1fr; }
    }

    .chart-fallback {
      padding: 48px 0;
      text-align: center;
      font-size: 13px;
      color: var(--text-secondary);
      background: rgba(17, 24, 39, 0.02);
      border: 1px dashed rgba(17, 24, 39, 0.08);
      border-radius: 14px;
    }
  </style>
</head>
<body>
  <div class="tech-shell">
    <h1 class="page-title">ç¡•èŠ½GEOå“ç‰Œåˆ†æå¹³å° Â· èŠ±è¥¿å­æ¡ˆä¾‹</h1>
    <p class="page-subtitle">GEO Alpha Â· AI é©±åŠ¨å“ç‰Œå…¨åŸŸæ´å¯Ÿé•œåƒï¼ˆBetaï¼‰</p>

    <div class="glass-card form-section">
      <h2 class="section-title">Step 1 Â· å“ç‰Œä¿¡æ¯å½•å…¥</h2>
      <div id="step1Form" class="form-section-body"></div>
      <div class="step-actions">
        <button class="step-btn primary">ä¸‹ä¸€æ­¥ Â· AI æ™ºèƒ½åˆ†æ</button>
            </div>
            </div>

    <div class="glass-card form-section">
      <h2 class="section-title">Step 2 Â· AI æ™ºèƒ½è¡¥å…¨</h2>
      <div id="step2Form" class="form-section-body"></div>
      <div class="analysis-card deep-direction-card" id="step2DeepDirection"></div>
      <div class="step-actions">
        <button class="step-btn">è¿”å›ä¿®æ”¹</button>
        <button class="step-btn primary">ç¡®è®¤å¹¶å¼€å§‹æ·±åº¦åˆ†æ</button>
            </div>
            </div>

    <div class="deep-analysis-header">
      <h2>Step 3 Â· æ·±åº¦åˆ†æ</h2>
      <div class="header-actions">
        <button class="action-btn primary">ç«‹å³æ¨å¹¿</button>
        <button class="action-btn outline">å¯¼å‡ºæ•°æ®</button>
            </div>
            </div>

    <div class="analysis-toolbar">
      <div class="tab-group">
        <button class="tab-btn active" data-tab="brand">å“ç‰Œè¯Šæ–­</button>
        <button class="tab-btn" data-tab="competitor">ç«å“å¯¹æ¯”</button>
        <button class="tab-btn" data-tab="media">åª’ä½“åˆ†å¸ƒ</button>
        <button class="tab-btn" data-tab="content">å†…å®¹ç­–ç•¥</button>
      </div>
      <div class="filter-chip-row" id="modelFilterChips"></div>
      </div>

    <div id="tab-brand"></div>
    <div id="tab-competitor" style="display:none;"></div>
    <div id="tab-media" style="display:none;"></div>
    <div id="tab-content" style="display:none;"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2/dist/echarts-wordcloud.min.js"></script>
  <script>
    const brandInfo = {
      brandName: 'èŠ±è¥¿å­',
      productService: 'ä¸œæ–¹å½©å¦† Â· ä»¥èŠ±å…»å¦†',
      industry: 'ç¾å¦† / å½©å¦†',
      brandDescription: 'ä¸œæ–¹å½©å¦†å“ç‰Œï¼Œèåˆéé—å·¥è‰ºä¸ç°ä»£å½©å¦†ç§‘æŠ€ï¼Œä¸»æ‰“ä¸œæ–¹ç¾å­¦ä½“éªŒã€‚',
      targetUsers: '18-35 å²å›½é£å¥³æ€§ Â· æˆåˆ†å…š Â· æ–‡åŒ–è®¤åŒæ„Ÿ',
      competitors: 'å®Œç¾æ—¥è®° / Colorkey / into you'
    };

    const analysisResult = {
      summary: 'èŠ±è¥¿å­åœ¨ AI æœç´¢ä¸­è¡¨ç°è‰¯å¥½ï¼Œå“ç‰Œå¯è§åº¦ 62%ï¼Œè¡Œä¸šæ’åç¬¬ 3ï¼›æƒ…æ„Ÿåº¦ 78% ä¿æŒå¥åº·ã€‚ä½†æ”¶å½•ç‡ä¸æ­£æ–‡å¼•ç”¨ç‡ä»æœ‰æå‡ç©ºé—´ï¼Œéœ€è¦å¼ºåŒ–ç»“æ„åŒ–å†…å®¹ä¸æŠ€æœ¯æƒå¨å»ºè®¾ã€‚',
      optimizedModels: [
        { name: 'DeepSeek', focus: 'æŠ€æœ¯æ·±åº¦ Â· ä¸“ä¸šå†…å®¹' },
        { name: 'è±†åŒ…', focus: 'å®ç”¨æ•™ç¨‹ Â· ç”¨æˆ·æŒ‡å—' },
        { name: 'å…ƒå®', focus: 'ç¤¾äº¤è¡¨è¾¾ Â· åœºæ™¯æ²Ÿé€š' }
      ],
      keyMedia: [
        { platform: 'å°çº¢ä¹¦', strategy: 'çœŸå®ä½¿ç”¨æ•…äº‹ + ä¸“ä¸šæµ‹è¯„' },
        { platform: 'æŠ–éŸ³', strategy: 'å¦†å®¹æ•™ç¨‹ + å›½æ½®åœºæ™¯' },
        { platform: 'çŸ¥ä¹', strategy: 'æˆåˆ†æŠ€æœ¯è§£æ + æƒå¨ç­”ç–‘' },
        { platform: 'æœç‹ç¾å¦†', strategy: 'è¡Œä¸šç™½çš®ä¹¦ + æ•°æ®å‘å¸ƒ' }
      ]
    };

    const deepAnalysisFlow = [
      { title: 'çœ‹é€ AI', description: 'è§£æä¸åŒæ¨¡å‹çš„æ¨èé€»è¾‘ï¼Œæ¢³ç†å½±å“æ’åºçš„å…³é”®å› å­ã€‚' },
      { title: 'å¯¹æ ‡ç«å“', description: 'ç²¾å‡†å®šä½è‡ªèº«ä¼˜åŠ¿ä¸çŸ­æ¿ï¼Œé”å®šèµ¶è¶…è·¯å¾„ã€‚' },
      { title: 'ä¼˜åŒ–åª’ä»‹', description: 'èšç„¦å…³é”®æ¸ é“ä¸è§¦ç‚¹ï¼Œæå‡æ¨¡å‹å¯è§åº¦ä¸æ”¶å½•ç‡ã€‚' },
      { title: 'åˆ¶å®šç­–ç•¥', description: 'ç”Ÿæˆä¸“å±å†…å®¹è“å›¾ï¼Œæ”¯æ’‘æ’åä¸è½¬åŒ–æŒç»­å¢é•¿ã€‚' }
    ];

    const competitorOverview = [
      {
        name: 'èŠ±è¥¿å­ Florasis',
        highlight: 'æœ¬å“ç‰Œ',
        logo: 'https://img.alicdn.com/imgextra//5f/69/TB1kOdCpk9l0K4jSZFK1rlFjpXa.JPG_760x760q30.jpg_.webp',
        filters: 'è¡Œä¸šï¼šå½©å¦† Â· ç›®æ ‡ç”¨æˆ·ï¼šä¸œæ–¹å®¡ç¾ Â· å“ç‰Œå®šä½ï¼šå›½é£é«˜ç«¯',
        insight: 'å“ç‰Œå£°é‡ä¸æƒ…æ„Ÿåº¦é¢†å…ˆï¼Œéœ€åŠ é€ŸæŠ€æœ¯æ²‰æ·€ä¸æ¨¡å‹æ·±åº¦ã€‚'
      },
      {
        name: 'å®Œç¾æ—¥è®° Perfect Diary',
        logo: 'https://img.alicdn.com/imgextra/i1/3375170974/O1CN014DgK8M1J48r6gQGEY_!!3375170974.png_760x760q30.jpg_.webp',
        filters: 'è¡Œä¸šï¼šå½©å¦† Â· ç›®æ ‡ç”¨æˆ·ï¼šå¤§ä¼—å¥³æ€§ Â· å“ç‰Œå®šä½ï¼šæ€§ä»·æ¯”å›½è´§',
        insight: 'æ¸ é“è¦†ç›–å¹¿ã€æ¨¡å‹åŸºç¡€æ‰å®ï¼Œæ˜¯ä¸»è¦å¯¹æ ‡å¯¹è±¡ã€‚'
      },
      {
        name: 'Colorkey',
        logo: 'https://img.alicdn.com/imgextra/i3/4144020062/O1CN01BxnUyA1CKRUjj3A5I_!!4144020062.png_760x760q30.jpg_.webp',
        filters: 'è¡Œä¸šï¼šå½©å¦† Â· ç›®æ ‡ç”¨æˆ·ï¼šå¹´è½»æ½®æµ Â· å“ç‰Œå®šä½ï¼šè‰²å½©ä¸“å®¶',
        insight: 'æƒ…æ„Ÿä¼˜åŠ¿çªå‡ºï¼Œå¯å€Ÿé‰´å…¶ç¤¾äº¤åŒ–å†…å®¹æ‰“æ³•ä¸äººç¾¤è¿è¥ã€‚'
      },
      {
        name: 'into you',
        logo: 'https://img.alicdn.com/imgextra/i1/2208156289515/O1CN01kxQ0Dz2K9veOvGW3t_!!2208156289515.jpg_760x760q30.jpg_.webp',
        filters: 'è¡Œä¸šï¼šå½©å¦† Â· ç›®æ ‡ç”¨æˆ·ï¼šZ ä¸–ä»£ Â· å“ç‰Œå®šä½ï¼šæ–°å›½æ½®å½©å¦†',
        insight: 'å¯è§åº¦ä¸æ¨¡å‹æ²‰æ·€åå¼±ï¼Œå­˜åœ¨è¿½èµ¶ä¸è¶…è¶Šç©ºé—´ã€‚'
      }
    ];

    const brandLogoMap = {
      'èŠ±è¥¿å­': 'https://img.alicdn.com/imgextra//5f/69/TB1kOdCpk9l0K4jSZFK1rlFjpXa.JPG_760x760q30.jpg_.webp',
      'å®Œç¾æ—¥è®°': 'https://img.alicdn.com/imgextra/i1/3375170974/O1CN014DgK8M1J48r6gQGEY_!!3375170974.png_760x760q30.jpg_.webp',
      'Colorkey': 'https://img.alicdn.com/imgextra/i3/4144020062/O1CN01BxnUyA1CKRUjj3A5I_!!4144020062.png_760x760q30.jpg_.webp',
      'into you': 'https://img.alicdn.com/imgextra/i1/2208156289515/O1CN01kxQ0Dz2K9veOvGW3t_!!2208156289515.jpg_760x760q30.jpg_.webp'
    };

    const competitorCoreSummary = 'èŠ±è¥¿å­å½“å‰å“ç‰Œå£°é‡æŒç»­èµ°é«˜ï¼Œæƒ…æ„Ÿå£ç¢‘ä¿æŒé¢†å…ˆï¼ŒAI è®¤çŸ¥æ·±åº¦ä»æœ‰æ‹“å±•ç©ºé—´ã€‚èŠ±è¥¿å­ä¸å®Œç¾æ—¥è®°æ„æˆå¤´éƒ¨åŒæ ¸å¿ƒï¼›Colorkey æƒ…æ„Ÿä¼˜åŠ¿çªå‡ºï¼›into you éœ€å¼ºåŒ–å¯è§åº¦ä¸æ¨¡å‹æ·±åº¦ã€‚';

    const mediaTopCoverage = [
      { rank: 1, media: 'å°çº¢ä¹¦', florasis: '82%', perfect: '78%', colorkey: '64%', intoYou: '55%', note: 'èŠ±è¥¿å­åœ¨ç²¾ç»†åŒ–æŠ¤è‚¤/å¦†å®¹è¯é¢˜è¦†ç›–é¢†å…ˆ' },
      { rank: 2, media: 'æŠ–éŸ³', florasis: '76%', perfect: '80%', colorkey: '58%', intoYou: '52%', note: 'å®Œç¾æ—¥è®°ç›´æ’­çŸ©é˜µæ›´å¼ºï¼ŒèŠ±è¥¿å­éœ€è¡¥é½çŸ­è§†é¢‘èŠ‚å¥' },
      { rank: 3, media: 'çŸ¥ä¹', florasis: '61%', perfect: '68%', colorkey: '54%', intoYou: '42%', note: 'èŠ±è¥¿å­ä¸“ä¸šé—®ç­”å æ¯”æå‡ï¼Œä½†ç»“æ„åŒ–å†…å®¹ä»æœ‰ç©ºé—´' },
      { rank: 4, media: 'å¾®åš', florasis: '58%', perfect: '63%', colorkey: '47%', intoYou: '41%', note: 'æƒ…æ„Ÿå£ç¢‘ç¨³å®šï¼Œéœ€ç»§ç»­å¼ºåŒ–ä»·å€¼æ²Ÿé€šä¸å±æœºå¤„ç†' },
      { rank: 5, media: 'æœç‹ç¾å¦†', florasis: '49%', perfect: '56%', colorkey: '44%', intoYou: '36%', note: 'æ·±åº¦æŠ¥å‘Šä»æ˜¯è“æµ·ï¼Œå¯åŠ å¤§æƒå¨åˆä½œè¾“å‡ºåŠ›åº¦' }
    ];

    const strategyMetrics = [
      { label: 'æ€»ä»»åŠ¡', value: '48 é¡¹' },
      { label: 'é‡ç‚¹å¹³å°', value: '6 ä¸ª' },
      { label: 'å†…å®¹ç±»å‹', value: '8 ç±»' },
      { label: 'æ‰§è¡Œå‘¨æœŸ', value: '12 å‘¨' },
      { label: 'é¢„æœŸæå‡', value: 'æ”¶å½•ç‡ +12%' }
    ];

    const strategyTimeline = [
      { phase: 'ç¬¬ 1-2 å‘¨', task: 'æŠ€æœ¯ç™½çš®ä¹¦ Â· ç»“æ„åŒ–è®ºæ®æ­å»º', progress: 38 },
      { phase: 'ç¬¬ 3-4 å‘¨', task: 'æ¨¡å‹å‹å¥½å†…å®¹é›†æˆ Â· æ•™ç¨‹ä½“ç³»åŒ–', progress: 58 },
      { phase: 'ç¬¬ 5-8 å‘¨', task: 'æ¡ˆä¾‹èµ„äº§æ²‰æ·€ Â· åœºæ™¯åŒ–å†…å®¹çŸ©é˜µ', progress: 82 },
      { phase: 'ç¬¬ 9-12 å‘¨', task: 'è¡Œä¸šæŠ¥å‘Šå‘å¸ƒ Â· èˆ†æƒ…/æƒ…æ„Ÿå·©å›º', progress: 100 }
    ];

    const platformStrategies = [
      {
        name: 'DeepSeek',
        weight: 'è®¡åˆ’æƒé‡ï¼š35%',
        goals: ['æŠ€æœ¯æ·±åº¦å†…å®¹', 'æƒå¨æ•°æ®å¼•ç”¨', 'ç»“æ„åŒ–è¡¨è¾¾']
      },
      {
        name: 'çŸ¥ä¹',
        weight: 'è®¡åˆ’æƒé‡ï¼š20%',
        goals: ['ä¸“ä¸šç­”ç–‘å¼ºåŒ–', 'å¼•ç”¨ç‡æå‡ 12%', 'ä¸“å®¶èƒŒä¹¦ä½“ç³»']
      },
      {
        name: 'æŠ–éŸ³',
        weight: 'è®¡åˆ’æƒé‡ï¼š18%',
        goals: ['åœºæ™¯åŒ–æ•™ç¨‹', 'æ¨¡å‹å‹å¥½è„šæœ¬', 'ç”¨æˆ·è§è¯ç›´æ’­']
      },
      {
        name: 'å°çº¢ä¹¦',
        weight: 'è®¡åˆ’æƒé‡ï¼š15%',
        goals: ['çœŸå®ä½“éªŒæ•…äº‹', 'æˆåˆ†å·®å¼‚åŒ–å™äº‹', 'æƒ…ç»ªè§¦è¾¾']
      }
    ];

    const contentGuidelines = [
      {
        title: 'æ¨¡å‹å‹å¥½æ ‡å‡†',
        items: ['ä½¿ç”¨ç»“æ„åŒ–æ ‡é¢˜ + æ‘˜è¦æ ¼å¼', 'å…³é”®è®ºæ®é…å¥—æ•°æ®ä¸æƒå¨å¼•ç”¨', 'å¼•å¯¼æ¨¡å‹ç†è§£å“ç‰Œå·®å¼‚ç‚¹']
      },
      {
        title: 'è´¨é‡æ£€éªŒæµç¨‹',
        items: ['ä¸‰è½®äº‹å®æ ¡éªŒä¸è¯­è¨€æ¶¦è‰²', 'AI æ ¸å¿ƒé—®ç­”è¦†ç›–ç‡ â‰¥ 90%', 'ä¸Šçº¿å‰èˆ†æƒ…æ•æ„Ÿè¯å®¡æŸ¥']
      }
    ];

    const mediaTypeDistribution = {
      brands: ['èŠ±è¥¿å­', 'å®Œç¾æ—¥è®°', 'Colorkey', 'into you'],
      categories: ['ç»“æ„åŒ–å†…å®¹', 'æƒå¨å¼•ç”¨', 'å®ç”¨æ•™ç¨‹', 'ç”¨æˆ·UGC', 'ç›´æ’­åœºæ™¯'],
      values: [
        [32, 24, 26, 22, 18],
        [28, 21, 30, 24, 26],
        [18, 16, 24, 28, 20],
        [14, 12, 20, 26, 24]
      ]
    };

    const mediaRecommendations = {
      risk: [
        'å°çº¢ä¹¦ï¼šå›´ç»•"è„±å¦†"ä¸"æŒå¦†"è®®é¢˜ï¼Œæ¨é€æƒå¨æµ‹è¯•ä¸ç”¨æˆ·è§è¯',
        'å¾®åšï¼šå¼ºåŒ–ä»·å€¼æ²Ÿé€šï¼Œçªå‡ºäº§å“å·¥è‰ºä¸æˆåˆ†ä¼˜åŠ¿',
        'å»ºç«‹ 7Ã—24 å°æ—¶èˆ†æƒ…ç›‘æ§æœºåˆ¶ï¼Œæ•æ·å¤„ç†æ½œåœ¨é£é™©'
      ],
      growth: [
        'æœç‹ç¾å¦†ï¼šæ·±åŒ–æŠ€æœ¯å†…å®¹åˆä½œï¼Œæ‰“é€ è¡Œä¸šæƒå¨èƒŒä¹¦',
        'çŸ¥ä¹ï¼šæ‰©å……ä¸“ä¸šé—®ç­”è¦†ç›–ï¼Œæå‡æ”¶å½•ç‡ä¸æƒ…æ„Ÿåº¦',
        'æŠ–éŸ³ï¼šå¼•å…¥åœºæ™¯åŒ–è§£å†³æ–¹æ¡ˆï¼Œæå‡æ¨¡å‹å¯è§åº¦'
      ]
    };

    const modelOperationHeatmap = [
      { model: 'DeepSeek', florasis: { score: 8.6, level: 'ä¼˜ç§€' }, perfect: { score: 6.1, level: 'è‰¯å¥½' }, colorkey: { score: 5.2, level: 'å¾…æ”¹å–„' }, intoYou: { score: 7.4, level: 'è‰¯å¥½' } },
      { model: 'è±†åŒ…', florasis: { score: 5.8, level: 'å¾…æ”¹å–„' }, perfect: { score: 8.3, level: 'ä¼˜ç§€' }, colorkey: { score: 7.6, level: 'ä¼˜ç§€' }, intoYou: { score: 6.3, level: 'è‰¯å¥½' } },
      { model: 'å…ƒå®', florasis: { score: 6.5, level: 'è‰¯å¥½' }, perfect: { score: 5.4, level: 'å¾…æ”¹å–„' }, colorkey: { score: 8.1, level: 'ä¼˜ç§€' }, intoYou: { score: 6.9, level: 'è‰¯å¥½' } },
      { model: 'Kimi', florasis: { score: 7.9, level: 'ä¼˜ç§€' }, perfect: { score: 6.7, level: 'è‰¯å¥½' }, colorkey: { score: 5.5, level: 'å¾…æ”¹å–„' }, intoYou: { score: 8.2, level: 'ä¼˜ç§€' } },
      { model: 'é€šä¹‰åƒé—®', florasis: { score: 6.0, level: 'è‰¯å¥½' }, perfect: { score: 5.1, level: 'å¾…æ”¹å–„' }, colorkey: { score: 7.0, level: 'è‰¯å¥½' }, intoYou: { score: 8.4, level: 'ä¼˜ç§€' } }
    ];

    const competitorRiskMatrix = [
      { dimension: 'æŠ€æœ¯è¢«èµ¶è¶…', florasis: 'ä¸­é£é™©ğŸŸ¡', perfect: 'ä½é£é™©ğŸŸ¢', colorkey: 'é«˜é£é™©ğŸ”´', intoYou: 'ä¸­é£é™©ğŸŸ¡' },
      { dimension: 'æƒ…æ„Ÿåº¦ä¸‹æ»‘', florasis: 'ä½é£é™©ğŸŸ¢', perfect: 'ä¸­é£é™©ğŸŸ¡', colorkey: 'ä½é£é™©ğŸŸ¢', intoYou: 'ä¸­é£é™©ğŸŸ¡' },
      { dimension: 'å¹³å°ä¾èµ–', florasis: 'ä¸­é£é™©ğŸŸ¡', perfect: 'ä½é£é™©ğŸŸ¢', colorkey: 'é«˜é£é™©ğŸ”´', intoYou: 'é«˜é£é™©ğŸ”´' },
      { dimension: 'å¢é•¿ä¹åŠ›', florasis: 'ä½é£é™©ğŸŸ¢', perfect: 'ä¸­é£é™©ğŸŸ¡', colorkey: 'ä¸­é£é™©ğŸŸ¡', intoYou: 'ä¸­é£é™©ğŸŸ¡' }
    ];

    const competitorInsights = {
      clusters: [
        'ğŸ”µ é¢†å¯¼é˜µè¥ï¼šå®Œç¾æ—¥è®° + èŠ±è¥¿å­ï¼Œå æ®å¤´éƒ¨åŒæ ¸å¿ƒ',
        'ğŸŸ¡ è¿½èµ¶é˜µè¥ï¼šColorkey + into youï¼ŒæŒç»­æŠ•å…¥ä½†æ·±åº¦ä¸è¶³'
      ],
      opportunities: [
        'å…ƒå®æ¨¡å‹ç«äº‰æ¸©å’Œï¼ŒæŠ•å…¥ 15% èµ„æºå¯å®ç°åè¶…',
        'æŠ€æœ¯èµ›é“ä»æœ‰æ·±è€•ç©ºé—´ï¼Œå¯æ„å»ºä¸“ä¸šå£å’',
        'æƒ…æ„Ÿä¼˜åŠ¿å¯è½¬åŒ–ä¸ºå£ç¢‘ä¼ æ’­ä¸æ¨èåŠ¨èƒ½'
      ],
      tactics: [
        'åŠ å¼ºæ¨¡å‹é¦–é€‰å†…å®¹æŠ•æ”¾ï¼Œå®ç°å¤šæ¨¡å‹ååŒæ›å…‰',
        'æ·±æŒ–æŠ€æœ¯å·®å¼‚åŒ–å™äº‹ï¼Œæå‡ä¸“ä¸šå¯ä¿¡åº¦',
        'æ„å»ºè·¨å¹³å°è”åŠ¨æ•…äº‹çº¿ï¼Œä¿æŒå…³æ³¨çƒ­åº¦'
      ],
      defenses: [
        'å»ºç«‹å¿«é€Ÿå“åº”æœºåˆ¶ï¼Œé™ä½èˆ†æƒ…æ‰©æ•£é£é™©',
        'ç›‘æµ‹ç«å“æŠ•æ”¾èŠ‚å¥ï¼Œçµæ´»è°ƒæ•´å†…å®¹æ¯”é‡',
        'ç»´æŒæ­£å‘å†…å®¹å æ¯”ï¼Œç¨³å›ºç”¨æˆ·æƒ…æ„Ÿè®¤åŒ'
      ]
    };

    const formFields = [
      { key: 'brandName', label: 'å“ç‰Œåç§°', row: 1, required: true, ai: false, type: 'input' },
      { key: 'productService', label: 'äº§å“æœåŠ¡', row: 1, required: true, ai: false, type: 'input' },
      { key: 'industry', label: 'æ‰€å±è¡Œä¸š', row: 1, required: false, ai: true, type: 'input' },
      { key: 'brandDescription', label: 'å“ç‰Œæè¿°', row: 2, required: false, ai: true, type: 'textarea' },
      { key: 'targetUsers', label: 'ç›®æ ‡äººç¾¤', row: 2, required: false, ai: true, type: 'textarea' },
      { key: 'competitors', label: 'ä¸»è¦ç«å“', row: 2, required: false, ai: true, type: 'textarea' }
    ];

    const metricsData = {
      visibility: 62,
      aiIndex: 7.2,
      rank: 3,
      textCitation: 12,
      inclusion: 18,
      share: 1.1,
      sentiment: 78,
      risk: 'æ­£å¸¸'
    };

    const metricTrends = {
      visibility: 'â†‘ +8%',
      aiIndex: 'â†‘ +0.6',
      rank: 'â†‘1ä½',
      textCitation: 'â†’',
      inclusion: 'â†‘ +3%',
      share: 'â†’',
      sentiment: 'â†‘ +5%',
      risk: 'ğŸŸ¢'
    };

    const keywordDesign = {
      'å“ç‰Œæ ¸å¿ƒå±‚': ['å“ç‰Œå', 'äº§å“å‹å·', 'ä¸“å±åŠŸèƒ½å'],
      'å“ç±»é€šç”¨å±‚': ['å“ç±»è¯', 'ä½¿ç”¨åœºæ™¯', 'è§£å†³æ–¹æ¡ˆ'],
      'é—®é¢˜æ¨¡å¼å±‚': ['æ€ä¹ˆæ ·', 'å¦‚ä½•', 'ä¸ºä»€ä¹ˆ', 'å¯¹æ¯”', 'æ¨è', 'æ±‚é—®', 'è¯·é—®', 'å“ª'],
      'ç—›ç‚¹éœ€æ±‚å±‚': ['é—®é¢˜', 'æ•…éšœ', 'ç¼ºç‚¹', 'ä¸å¥½ç”¨', 'æ±‚åŠ©']
    };

    const questionWordCloudData = [
      { name: 'æ—¥å¸¸å¦†å®¹', value: 68 },
      { name: 'çº¦ä¼šå¦†å®¹', value: 52 },
      { name: 'èŒåœºå¦†å®¹', value: 45 },
      { name: 'æ•æ„Ÿè‚Œ', value: 62 },
      { name: 'æ²¹çš®é—®é¢˜', value: 58 },
      { name: 'æŒå¦†æŠ€å·§', value: 71 },
      { name: 'æˆåˆ†å®‰å…¨', value: 49 },
      { name: 'å­¦ç”Ÿå…š', value: 41 },
      { name: 'å›½é£å½©å¦†', value: 38 },
      { name: 'å¿«é€Ÿä¸Šå¦†', value: 55 },
      { name: 'ä¸è„±å¦†', value: 63 },
      { name: 'å…»è‚¤å½©å¦†', value: 35 },
      { name: 'é›•èŠ±å·¥è‰º', value: 42 },
      { name: 'ä¸œæ–¹ç¾å­¦', value: 37 },
      { name: 'å­•å¦‡å¯ç”¨', value: 28 }
    ];

    const socialQuestions = [
      {
        platform: 'å°çº¢ä¹¦',
        items: [
          { title: 'èŠ±è¥¿å­é›•èŠ±å£çº¢å€¼å¾—ä¹°å—ï¼Ÿ', badge: 'ğŸ”¥ 2.1ä¸‡æ”¶è—', url: 'https://www.xiaohongshu.com/explore/65ff23a4c123000001234567' },
          { title: 'èŠ±è¥¿å­å®šå¦†æ•£ç²‰çœŸçš„ä¸è„±å¦†å—ï¼Ÿ', badge: 'ğŸ”¥ 1.9ä¸‡æµè§ˆ', url: 'https://www.xiaohongshu.com/explore/6620a0bd8123000001123456' },
          { title: 'æ•æ„Ÿè‚Œå¯ä»¥ç”¨èŠ±è¥¿å­åº•å¦†å—ï¼Ÿ', badge: 'ğŸ”¥ 1.6ä¸‡è®¨è®º', url: 'https://www.xiaohongshu.com/explore/65d210fbc456000001234567' },
          { title: 'èŠ±è¥¿å­æ–°æ‰‹å½©å¦†å¥—è£…æ€ä¹ˆé€‰ï¼Ÿ', badge: 'ğŸ”¥ 1.4ä¸‡æ”¶è—', url: 'https://www.xiaohongshu.com/explore/660a1b24a123000001234abc' },
          { title: 'ä¸œæ–¹ç¾å­¦å¦†å®¹æ€ä¹ˆç”»ï¼Ÿ', badge: 'ğŸ”¥ 1.2ä¸‡æµè§ˆ', url: 'https://www.xiaohongshu.com/explore/65c1e0fa9123000001abc234' }
        ]
      },
      {
        platform: 'çŸ¥ä¹',
        items: [
          { title: 'èŠ±è¥¿å­çš„å½©å¦†åˆ°åº•å¥½ç”¨å—ï¼Ÿ', badge: 'ğŸ”¥ 2.3ä¸‡å…³æ³¨', url: 'https://www.zhihu.com/question/667712345' },
          { title: 'èŠ±è¥¿å­å’Œå®Œç¾æ—¥è®°å“ªä¸ªæ›´å€¼å¾—ä¹°ï¼Ÿ', badge: 'ğŸ”¥ 1.8ä¸‡å›ç­”', url: 'https://www.zhihu.com/question/666123987' },
          { title: 'èŠ±è¥¿å­çš„å“ç‰Œæ•…äº‹æ˜¯çœŸå®çš„å—ï¼Ÿ', badge: 'ğŸ”¥ 1.3ä¸‡æµè§ˆ', url: 'https://www.zhihu.com/question/668001234' },
          { title: 'æ•æ„Ÿè‚Œä½¿ç”¨èŠ±è¥¿å­ä¼šè¿‡æ•å—ï¼Ÿ', badge: 'ğŸ”¥ 9åƒè®¨è®º', url: 'https://www.zhihu.com/question/665890123' },
          { title: 'å¦‚ä½•è¯„ä»·èŠ±è¥¿å­çš„äº§å“çº¿å¸ƒå±€ï¼Ÿ', badge: 'ğŸ”¥ 8åƒå›ç­”', url: 'https://www.zhihu.com/question/669120456' }
        ]
      },
      {
        platform: 'ä»€ä¹ˆå€¼å¾—ä¹°',
        items: [
          { title: 'èŠ±è¥¿å­é›•èŠ±å£çº¢å€¼å¾—å…¥æ‰‹å—ï¼Ÿ', badge: 'ğŸ”¥ 2.0ä¸‡å€¼å‹çƒ­è®®', url: 'https://www.smzdm.com/p/123456789/' },
          { title: 'èŠ±è¥¿å­ç²‰åº•æ¶²å’Œå®Œç¾æ—¥è®°æ€ä¹ˆé€‰ï¼Ÿ', badge: 'ğŸ”¥ 1.6ä¸‡å€¼å‹ç‚¹è¯„', url: 'https://www.smzdm.com/p/223344556/' },
          { title: 'èŠ±è¥¿å­æœ‰å“ªäº›å¿…ä¹°å½©å¦†å•å“ï¼Ÿ', badge: 'ğŸ”¥ 1.4ä¸‡å€¼å‹æ¨è', url: 'https://www.smzdm.com/p/334455667/' },
          { title: 'èŠ±è¥¿å­é™å®šç¤¼ç›’å€¼ä¸å€¼å¾—ï¼Ÿ', badge: 'ğŸ”¥ 1.2ä¸‡å€¼å‹æ”¶è—', url: 'https://www.smzdm.com/p/445566778/' },
          { title: 'èŠ±è¥¿å­æ–°å“ä¸Šå¸‚æœ‰å“ªäº›äº®ç‚¹ï¼Ÿ', badge: 'ğŸ”¥ 9åƒå€¼å‹å…³æ³¨', url: 'https://www.smzdm.com/p/556677889/' }
        ]
      }
    ];

    const aiHighFrequency = [
      { text: 'æ—¥å¸¸é€šå‹¤æŒå¦†æ–¹æ¡ˆï¼Ÿ', badge: 'ğŸ” æœç´¢é‡+æ„å›¾' },
      { text: 'æ•æ„Ÿè‚Œå¯ä»¥ç”¨å“ªäº›å½©å¦†ï¼Ÿ', badge: 'ğŸ” æˆåˆ†å®‰å…¨' },
      { text: 'å†¬å­£åº•å¦†å¦‚ä½•é˜²è„±ï¼Ÿ', badge: 'ğŸ” å­£èŠ‚éœ€æ±‚' },
      { text: 'å­¦ç”Ÿå…šæ€§ä»·æ¯”å½©å¦†ï¼Ÿ', badge: 'ğŸ” ä»·æ ¼æ•æ„Ÿ' },
      { text: 'èŠ±è¥¿å­æ–°å“é¦–å‘å“ªé‡Œä¹°ï¼Ÿ', badge: 'ğŸ” äº¤æ˜“é—­ç¯' }
    ];

    const aiDeepQuestions = [
      { text: 'èŠ±è¥¿å­é›•èŠ±å£çº¢é€‚åˆä»€ä¹ˆåœºåˆï¼Ÿ', badge: 'ğŸ” åœºæ™¯æ˜ å°„' },
      { text: 'èŠ±è¥¿å­ç²‰åº•é®ç‘•åº¦å¦‚ä½•ï¼Ÿ', badge: 'ğŸ” åŠŸèƒ½å‚æ•°' },
      { text: 'æ•æ„Ÿè‚Œé€‰æ‹©èŠ±è¥¿å­å“ªäº›äº§å“ï¼Ÿ', badge: 'ğŸ” æˆåˆ†åŒ¹é…' },
      { text: 'ä¸œæ–¹ç¾å­¦å·®å¼‚ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ', badge: 'ğŸ” å“ç‰Œå®šä½' },
      { text: 'èŠ±è¥¿å­å¦‚ä½•æ„å»ºå“ç‰ŒæŠ¤åŸæ²³ï¼Ÿ', badge: 'ğŸ” ç­–ç•¥å»¶å±•' }
    ];

    const strategicMatrix = [
      {
        risk: 'ğŸ”´ é«˜æŠ€æœ¯è®¤çŸ¥é£é™©',
        diagnosis: ['AI è®¤çŸ¥ 7.2ï¼ˆ-35% vs ç«å“ï¼‰', 'æ”¶å½•ç‡ 17%ï¼ˆç«å“ 25%-30%ï¼‰', 'å½±å“ï¼šæŠ€æœ¯å®šä»·æƒç¼ºå¤±'],
        responseTitle: 'æŠ€æœ¯æƒå¨ä½“ç³»',
        responseItems: ['æˆåˆ†ç™½çš®ä¹¦ï¼ˆ30+ æˆåˆ†ï¼‰', 'ä¸“å®¶ç½‘ç»œï¼ˆ5+ çš®è‚¤ç§‘ï¼‰', 'è¡Œä¸šæ ‡å‡†åˆ¶å®š'],
        goal: 'ç›®æ ‡ï¼šæ”¶å½•ç‡ 25%+'
      },
      {
        risk: 'ğŸŸ¡ ä¸­é«˜å†…å®¹è´¨é‡é£é™©',
        diagnosis: ['æ­£æ–‡å¼•ç”¨ç‡ 12%ï¼ˆç«å“ 15%-22%ï¼‰', 'è®ºæ®ç¼ºå¤± 28%ï¼Œé•¿å°¾è¦†ç›– 65%', 'å½±å“ï¼šAI å›ç­”ç¼ºä¹æ”¯æ’‘'],
        responseTitle: 'å†…å®¹è´¨é‡ä¼˜åŒ–',
        responseItems: ['å…³é”®è¯çŸ©é˜µï¼ˆ200+ï¼‰', 'é—®ç­”å¯¹åº“ï¼ˆ500+ï¼‰', 'æ·±åº¦å†…å®¹å»ºè®¾'],
        goal: 'ç›®æ ‡ï¼šè¡Œä¸šæ’å ç¬¬3â†’ç¬¬2'
      },
      {
        risk: 'ğŸŸ¡ ä¸­ç”¨æˆ·æƒ…æ„Ÿé£é™©',
        diagnosis: ['æƒ…æ„Ÿåº¦ 78%ï¼ˆç«å“ 82%-85%ï¼‰', 'è´Ÿé¢ 3%ï¼ˆ"è„±å¦†å¿«"ï¼‰', 'å½±å“ï¼šè½¬åŒ–ç‡ä¸å¤è´­ä¸‹æ»‘'],
        responseTitle: 'æƒ…æ„Ÿè¿æ¥ä¿®å¤',
        responseItems: ['æŒå¦†æŠ€æœ¯æ–¹æ¡ˆ', 'æ•™ç¨‹å†…å®¹ä½“ç³»', 'ç”¨æˆ·è§è¯ï¼ˆ1000+ æ¡ˆä¾‹ï¼‰'],
        goal: 'ç›®æ ‡ï¼šæƒ…æ„Ÿåº¦ 85%+'
      }
    ];

    const strategicSummary = {
      priority: '1. æŠ€æœ¯æƒå¨ â†’ 2. å†…å®¹è´¨é‡ â†’ 3. æƒ…æ„Ÿä¼˜åŒ–',
      timeline: 'æŠ€æœ¯ï¼ˆ1-3 æœˆï¼‰ Â· å†…å®¹ï¼ˆæŒç»­ï¼‰ Â· æƒ…æ„Ÿï¼ˆ2-4 å‘¨ï¼‰'
    };

    const competitorSummaryBoard = [
      { name: 'èŠ±è¥¿å­', visibility: 62, aiIndex: 7.2, sentiment: 78, textCitation: 12, inclusion: 18, share: 1.1, rank: 'ç¬¬3å' },
      { name: 'å®Œç¾æ—¥è®°', visibility: 75, aiIndex: 7.8, sentiment: 72, textCitation: 15, inclusion: 22, share: 1.3, rank: 'ç¬¬2å' },
      { name: 'Colorkey', visibility: 45, aiIndex: 6.5, sentiment: 80, textCitation: 10, inclusion: 15, share: 0.9, rank: 'ç¬¬5å' },
      { name: 'into you', visibility: 38, aiIndex: 6.2, sentiment: 75, textCitation: 8, inclusion: 12, share: 0.8, rank: 'ç¬¬6å' }
    ];

    const competitorTrendSeries = {
      months: ['2024-10', '2024-11', '2024-12', '2025-01', '2025-02', '2025-03'],
      visibility: {
        'èŠ±è¥¿å­': [54, 56, 58, 60, 62, 63],
        'å®Œç¾æ—¥è®°': [70, 71, 72, 73, 75, 76],
        'Colorkey': [38, 39, 41, 43, 44, 45],
        'into you': [34, 35, 36, 37, 38, 39]
      },
      aiIndex: {
        'èŠ±è¥¿å­': [6.8, 6.9, 7.0, 7.1, 7.2, 7.3],
        'å®Œç¾æ—¥è®°': [7.4, 7.5, 7.6, 7.7, 7.8, 7.9],
        'Colorkey': [6.1, 6.2, 6.3, 6.4, 6.5, 6.6],
        'into you': [5.9, 6.0, 6.1, 6.1, 6.2, 6.3]
      }
    };

    const mediaHeatmapMatrix = {
      platforms: ['å°çº¢ä¹¦', 'æŠ–éŸ³', 'çŸ¥ä¹', 'å¾®åš', 'æœç‹ç¾å¦†', 'Bç«™'],
      metrics: ['æ”¶å½•ç‡', 'æƒ…æ„Ÿåº¦', 'æ­£é¢å£°é‡', 'è´Ÿé¢å£°é‡', 'é£é™©ç­‰çº§'],
      data: [
        [25, 82, 85, 8, 65],
        [20, 75, 78, 12, 70],
        [18, 85, 88, 5, 85],
        [15, 70, 73, 18, 55],
        [12, 88, 90, 4, 90],
        [14, 80, 84, 7, 75]
      ]
    };

    const mediaEffectScatter = [
      { name: 'å°çº¢ä¹¦', value: [85, 90, 12] },
      { name: 'æŠ–éŸ³', value: [75, 65, 25] },
      { name: 'çŸ¥ä¹', value: [70, 85, 18] },
      { name: 'å¾®åš', value: [60, 55, 15] },
      { name: 'æœç‹ç¾å¦†', value: [68, 92, 20] },
      { name: 'Bç«™', value: [72, 78, 14] }
    ];

    const mediaRiskRows = [
      { platform: 'å°çº¢ä¹¦', status: 'ä½é£é™©', focus: 'è„±å¦†è®®é¢˜', action: 'å»ºç«‹"å›½é£ä¸è„±å¦†"å®ˆæŠ¤è®¡åˆ’' },
      { platform: 'æŠ–éŸ³', status: 'ä¸­é£é™©', focus: 'å†…å®¹åŒè´¨åŒ–', action: 'å‡çº§æ•™ç¨‹è„šæœ¬ï¼ŒåŠ å…¥å·®å¼‚åŒ–åœºæ™¯' },
      { platform: 'çŸ¥ä¹', status: 'ä½é£é™©', focus: 'ä¸“ä¸šç­”ç–‘è–„å¼±', action: 'è¡¥å……ç»“æ„åŒ–æŠ€æœ¯é—®ç­”' },
      { platform: 'å¾®åš', status: 'ä¸­é£é™©', focus: 'ä»·æ ¼è®¨è®º', action: 'å¼ºåŒ–ä»·å€¼æ²Ÿé€š + å®˜æ–¹æ¾„æ¸…' },
      { platform: 'æœç‹ç¾å¦†', status: 'ä½é£é™©', focus: 'æ·±åº¦æŠ¥é“ç¨€ç¼º', action: 'è”åˆå‘å¸ƒè¡Œä¸šæ´å¯Ÿ' }
    ];

    const contentDistributions = [
      {
        brand: 'èŠ±è¥¿å­',
        types: [
          { label: 'å›½é£æ–‡åŒ–', value: 40 },
          { label: 'äº§å“è¯„æµ‹', value: 20 },
          { label: 'æˆåˆ†è§£æ', value: 16 },
          { label: 'ç”¨æˆ·æ•…äº‹', value: 12 },
          { label: 'æ´»åŠ¨ä¿ƒé”€', value: 8 },
          { label: 'å…¶ä»–', value: 4 }
        ]
      },
      {
        brand: 'å®Œç¾æ—¥è®°',
        types: [
          { label: 'äº§å“è¯„æµ‹', value: 32 },
          { label: 'KOL åˆä½œ', value: 28 },
          { label: 'ç”¨æˆ·æ•…äº‹', value: 20 },
          { label: 'æ´»åŠ¨ä¿ƒé”€', value: 16 },
          { label: 'å…¶ä»–', value: 4 }
        ]
      },
      {
        brand: 'Colorkey',
        types: [
          { label: 'è‰²å½©æ•™ç¨‹', value: 40 },
          { label: 'äº§å“è¯„æµ‹', value: 28 },
          { label: 'ç”¨æˆ·UGC', value: 20 },
          { label: 'æ´»åŠ¨ä¿ƒé”€', value: 8 },
          { label: 'å…¶ä»–', value: 4 }
        ]
      },
      {
        brand: 'into you',
        types: [
          { label: 'è‰²å½©æ•™ç¨‹', value: 48 },
          { label: 'ç”¨æˆ·UGC', value: 20 },
          { label: 'äº§å“è¯„æµ‹', value: 20 },
          { label: 'KOL åˆä½œ', value: 12 }
        ]
      }
    ];

    const contentPerformanceMetrics = [
      { metric: 'æ—¥æ›´æ–°é‡', data: { 'èŠ±è¥¿å­': 25, 'å®Œç¾æ—¥è®°': 38, 'Colorkey': 30, 'into you': 45 } },
      { metric: 'å¹³å‡äº’åŠ¨ç‡', data: { 'èŠ±è¥¿å­': '3.2%', 'å®Œç¾æ—¥è®°': '2.8%', 'Colorkey': '4.1%', 'into you': '3.5%' } },
      { metric: 'çˆ†æ–‡ç‡', data: { 'èŠ±è¥¿å­': '12%', 'å®Œç¾æ—¥è®°': '15%', 'Colorkey': '18%', 'into you': '22%' } },
      { metric: 'å†…å®¹æ·±åº¦', data: { 'èŠ±è¥¿å­': 'é«˜', 'å®Œç¾æ—¥è®°': 'ä¸­', 'Colorkey': 'ä¸­é«˜', 'into you': 'ä¸­' } }
    ];

    const contentTopicHighlights = [
      { brand: 'èŠ±è¥¿å­', topics: ['å›½é£å½©å¦†', 'ä¸œæ–¹ç¾å­¦', 'æˆåˆ†å®‰å…¨', 'éé—åˆä½œ'] },
      { brand: 'å®Œç¾æ—¥è®°', topics: ['åŠ¨ç‰©çœ¼å½±', 'æ€§ä»·æ¯”', 'å­¦ç”Ÿå…š', 'è”åæ¬¾'] },
      { brand: 'Colorkey', topics: ['ç©ºæ°”å”‡é‡‰', 'è‰²å½©ä¸“å®¶', 'è´¨åœ°åˆ›æ–°', 'æ˜æ˜ŸåŒæ¬¾'] },
      { brand: 'into you', topics: ['å”‡æ³¥å¼€åˆ›è€…', 'æ˜¾ç™½ç¥å™¨', 'æ–°å›½æ½®', 'æƒ…ç»ªè¡¨è¾¾'] }
    ];

    const modelPerformanceData = [
      {
        name: 'DeepSeek',
        logo: 'https://gbres.dfcfw.com/Files/picture/20250302/D9224AEE925FAAE0E28D58D91C88E2A2_w1079h1054.jpg',
        weight: '35%',
        visibility: 65,
        aiIndex: 7.6,
        operationDepth: 'æ·±åº¦è¿è¥',
        mediaDistribution: 'æŠ€æœ¯åª’ä½“ Â· è¡Œä¸šè®ºå›',
        contentPreference: 'æŠ€æœ¯æ·±åº¦'
      },
      {
        name: 'è±†åŒ…',
        logo: 'https://q6.itc.cn/images01/20250701/0ea239c9a5124f0fbb1e49c26539bbdd.png',
        weight: '25%',
        visibility: 60,
        aiIndex: 7.1,
        operationDepth: 'å‡è¡¡è¿è¥',
        mediaDistribution: 'ç”Ÿæ´»æ–¹å¼ Â· ç¤¾äº¤æ¸ é“',
        contentPreference: 'å®ç”¨æ•™ç¨‹'
      },
      {
        name: 'å…ƒå®',
        logo: 'https://static.yuanbao.tencent.com/modern/_next/static/media/logo_light.d078142a.svg',
        weight: '20%',
        visibility: 58,
        aiIndex: 6.8,
        operationDepth: 'å¾…æå‡',
        mediaDistribution: 'æ³›å¨±ä¹ Â· ç¤¾åŒº',
        contentPreference: 'ç¤¾äº¤äº’åŠ¨'
      },
      {
        name: 'Kimi',
        logo: 'https://q8.itc.cn/q_70/images03/20241117/1c2ce659687d4b859d52c8e152b095a0.jpeg',
        weight: '12%',
        visibility: 55,
        aiIndex: 6.5,
        operationDepth: 'åŸºç¡€ç»´æŠ¤',
        mediaDistribution: 'é•¿å†…å®¹å¹³å°',
        contentPreference: 'é•¿æ–‡æœ¬'
      },
      {
        name: 'é€šä¹‰åƒé—®',
        logo: 'https://img.alicdn.com/tps/i4/2216981282594/O1CN01KhpK3A1V26LvVWu7L_!!2216981282594.png',
        weight: '8%',
        visibility: 52,
        aiIndex: 6.3,
        operationDepth: 'åŸºç¡€ç»´æŠ¤',
        mediaDistribution: 'ç»¼åˆèµ„è®¯',
        contentPreference: 'æ—¥å¸¸ç”Ÿæ´»'
      }
    ];

    const modelFilterOptions = ['å…¨éƒ¨æ¨¡å‹', 'DeepSeek', 'è±†åŒ…', 'å…ƒå®', 'Kimi', 'é€šä¹‰åƒé—®'];
    let activeModelFilter = 'å…¨éƒ¨æ¨¡å‹';

    const logoPatternCache = {};
    const logoSymbolCache = {};

    function $(id) { return document.getElementById(id); }

    function escapeHTML(str = '') {
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    function getFieldValue(key) {
      return brandInfo[key] || '';
    }

    function renderFormSection(targetId, mode) {
      const container = $(targetId);
      if (!container) return;
      const rows = [1, 2].map(row => formFields.filter(field => field.row === row)
        .map(field => {
          const aiBadgeText = mode === 'ai' ? 'AI å·²è¡¥å…¨' : 'AI å¯è¡¥å…¨';
          const suffix = field.required
            ? '<span class="field-required">*</span>'
            : field.ai
              ? `<span class="field-ai">${aiBadgeText}</span>`
              : '';
          const label = `${field.label}${suffix}`;
          const raw = getFieldValue(field.key);
          const control = mode === 'ai'
            ? `<div class="form-value">${raw ? escapeHTML(raw) : 'AI è¡¥å…¨ä¸­â€¦'}</div>`
            : field.type === 'textarea'
              ? `<textarea>${escapeHTML(raw)}</textarea>`
              : `<input type="text" value="${escapeHTML(raw)}" />`;
          return `<div class="form-field"><label class="form-label">${label}</label>${control}</div>`;
        }));
      container.innerHTML = rows.map(rowFields => `<div class="form-row">${rowFields.join('')}</div>`).join('');
    }

    function renderStep2DeepDirection() {
      const container = $('step2DeepDirection');
      if (!container) return;
      container.innerHTML = `
        <h3 style="margin:0 0 12px; font-size:14px; color:var(--accent-dark);">ğŸ”­ æ·±åº¦åˆ†ææ–¹å‘</h3>
        <div class="analysis-flow">
          ${deepAnalysisFlow.map((step, index) => `
            <div class="analysis-flow-item">
              <span style="font-size:24px; color:var(--accent-dark);">${(index + 1).toString().padStart(2, '0')}</span>
              <strong style="font-size:13px; color:var(--accent-dark);">${step.title}</strong>
              <span style="font-size:12.5px; color:var(--text-secondary); line-height:1.6;">${step.description}</span>
        </div>
          `).join('')}
        </div>`;
    }

    function buildMetricCard(title, value, trend, baseline) {
      return `
        <div class="metric-card">
          <strong>${title}</strong>
          <div class="metric-trend">${value} <span style="margin-left:6px; color:${trend.includes('â†‘') ? '#15803d' : trend.includes('â†“') ? '#b91c1c' : '#4b5563'};">${trend}</span></div>
          <div class="metric-baseline">${baseline}</div>
        </div>`;
    }

    function renderGlobalModelFilters() {
      const container = $('modelFilterChips');
      if (!container) return;
      container.innerHTML = modelFilterOptions
        .map(option => `<button class="filter-chip${option === activeModelFilter ? ' active' : ''}" data-filter="${option}">${option}</button>`)
        .join('');
      container.querySelectorAll('.filter-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          activeModelFilter = chip.dataset.filter;
          renderGlobalModelFilters();
        });
      });
    }

    function renderQuestionWordCloud() {
      const dom = $('questionWordCloud');
      if (!dom) return;
      try {
        const instance = echarts.init(dom);
        const palette = ['#111827', '#d97706', '#2563eb', '#0f766e', '#ec4899', '#f97316', '#d4af37'];
        instance.setOption({
          tooltip: { show: false },
          series: [{
            type: 'wordCloud',
            gridSize: 8,
            sizeRange: [14, 46],
            rotationRange: [0, 0],
            shape: 'circle',
            textStyle: {
              fontFamily: 'PingFang SC, sans-serif',
              color: () => palette[Math.floor(Math.random() * palette.length)],
            },
            data: questionWordCloudData,
          }],
        });
        window.addEventListener('resize', () => instance.resize());
      } catch (error) {
        console.error('[GEO] word cloud error:', error);
        dom.innerHTML = '<div class="chart-fallback">è¯äº‘åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function buildStrategicTable() {
      const flow = strategicMatrix
        .map((item, index) => {
          const riskName = item.risk.replace(/^[^\u4e00-\u9fa5a-zA-Z0-9]+\s*/, '');
          const severity = item.risk.startsWith('ğŸ”´')
            ? 'high'
            : item.risk.startsWith('ğŸŸ¡')
              ? 'medium'
              : 'low';
          const diagnosisList = item.diagnosis.map(line => `<li>${line}</li>`).join('');
          const solutionList = item.responseItems.map(entry => `<li>${entry}</li>`).join('');
          const goal = item.goal ? `<div class="strategy-node-foot">${item.goal}</div>` : '';
          return `
            <div class="strategy-node">
              <div class="strategy-node-header">
                <span class="strategy-step">${String(index + 1).padStart(2, '0')}</span>
                <span class="strategy-risk ${severity}">${riskName}</span>
              </div>
              <div class="strategy-node-body">
                <div class="strategy-node-section">
                  <span class="strategy-node-label">æŒ‘æˆ˜è¯Šæ–­</span>
                  <ul>${diagnosisList}</ul>
                </div>
                <div class="strategy-node-section">
                  <span class="strategy-node-label">æˆ˜ç•¥ç ´å±€ Â· ${item.responseTitle}</span>
                  <ul>${solutionList}</ul>
                  ${goal}
                </div>
              </div>
            </div>`;
        })
        .join('');

      return `
        <div class="strategy-table-wrapper">
          <div class="strategy-summary-inline">
            <span class="analysis-badge">æ‰§è¡Œä¼˜å…ˆçº§</span>
            <span>${strategicSummary.priority}</span>
            <span class="analysis-badge">æ—¶é—´æ¡†æ¶</span>
            <span>${strategicSummary.timeline}</span>
          </div>
          <div class="strategy-flow">${flow}</div>
        </div>`;
    }

    function renderModelPerformanceCards() {
      const container = $('modelPerformance');
      if (!container) return;
      container.innerHTML = modelPerformanceData
        .map(model => `
          <div class="question-card model-card">
            <div class="model-card-header">
              <div class="model-logo">${model.logo ? `<img src="${model.logo}" alt="${model.name}" />` : `<span>${model.name.slice(0, 2)}</span>`}</div>
              <h4 style="margin:0; font-size:13px; color:var(--accent-dark);">${model.name}</h4>
            </div>
            <div class="model-info-row"><span>æƒé‡</span><strong>${model.weight}</strong></div>
            <div class="model-info-row"><span>å“ç‰Œå¯è§åº¦</span><strong>${model.visibility}%</strong></div>
            <div class="model-info-row"><span>AI è®¤çŸ¥æŒ‡æ•°</span><strong>${Number(model.aiIndex).toFixed(1)}</strong></div>
            <div class="model-info-row"><span>è¿è¥æ·±åº¦</span><strong>${model.operationDepth}</strong></div>
            <div class="model-info-row"><span>åª’ä½“åˆ†å¸ƒ</span><strong>${model.mediaDistribution}</strong></div>
            <div class="model-info-row"><span>å†…å®¹åå¥½</span><strong>${model.contentPreference}</strong></div>
          </div>`)
        .join('');
    }

    function buildCompetitorSummaryTable() {
      const headers = ['å“ç‰Œ', 'å“ç‰Œå¯è§åº¦', 'AI è®¤çŸ¥æŒ‡æ•°', 'å“ç‰Œæ’å', 'æ­£æ–‡å¼•ç”¨ç‡', 'æ”¶å½•ç‡', 'AI è®¤çŸ¥ä»½é¢æŒ‡æ•°', 'æƒ…æ„Ÿåº¦'];
      const rows = competitorSummaryBoard
        .map(item => `
          <tr>
            <td>${item.name}</td>
            <td>${item.visibility}%</td>
            <td>${item.aiIndex.toFixed(1)}</td>
            <td>${item.rank}</td>
            <td>${item.textCitation}%</td>
            <td>${item.inclusion}%</td>
            <td>${(item.share || 0).toFixed ? item.share.toFixed(1) : item.share}</td>
            <td>${item.sentiment}%</td>
          </tr>`)
        .join('');
      return `
        <table class="data-table">
          <thead><tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr></thead>
          <tbody>${rows}</tbody>
        </table>`;
    }

    function renderCompetitorRadarChart() {
      const dom = $('competitorRadarChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        chart.setOption({
          tooltip: { trigger: 'item' },
          legend: { show: false },
          radar: {
            indicator: [
              { name: 'å“ç‰Œå¯è§åº¦', max: 80 },
              { name: 'AI è®¤çŸ¥æŒ‡æ•°', max: 8 },
              { name: 'æƒ…æ„Ÿåº¦', max: 85 },
              { name: 'æ­£æ–‡å¼•ç”¨ç‡', max: 18 },
              { name: 'æ”¶å½•ç‡', max: 25 }
            ],
            center: ['50%', '50%'],
            radius: '65%',
            splitNumber: 5,
            splitLine: { lineStyle: { color: ['rgba(17,24,39,0.14)'] } },
            splitArea: {
              show: true,
              areaStyle: { color: ['rgba(17,24,39,0.03)', 'rgba(212,175,55,0.05)'] }
            },
            axisLine: { lineStyle: { color: 'rgba(17,24,39,0.18)' } },
            nameGap: 6,
            name: {
              color: '#111827',
              fontSize: 12,
              backgroundColor: 'rgba(255,255,255,0.9)',
              padding: [3, 8],
              borderRadius: 10
            }
          },
          series: [{
            type: 'radar',
            lineStyle: { width: 2 },
            symbol: 'circle',
            symbolSize: 4,
            data: competitorSummaryBoard.map(item => ({
              name: item.name,
              value: [item.visibility, item.aiIndex, item.sentiment, item.textCitation, item.inclusion],
              lineStyle: {
                color:
                  item.name === 'èŠ±è¥¿å­' ? '#2563eb' :
                  item.name === 'å®Œç¾æ—¥è®°' ? '#16a34a' :
                  item.name === 'Colorkey' ? '#f59e0b' :
                  '#8b5cf6'
              },
              itemStyle: {
                color:
                  item.name === 'èŠ±è¥¿å­' ? '#2563eb' :
                  item.name === 'å®Œç¾æ—¥è®°' ? '#16a34a' :
                  item.name === 'Colorkey' ? '#f59e0b' :
                  '#8b5cf6'
              },
              areaStyle: {
                color:
                  item.name === 'èŠ±è¥¿å­' ? 'rgba(37,99,235,0.22)' :
                  item.name === 'å®Œç¾æ—¥è®°' ? 'rgba(34,197,94,0.18)' :
                  item.name === 'Colorkey' ? 'rgba(245,158,11,0.18)' :
                  'rgba(139,92,246,0.18)'
              }
            }))
          }]
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] competitor radar error:', error);
        dom.innerHTML = '<div class="chart-fallback">ç«å“é›·è¾¾å›¾åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function renderCompetitorTrendChart() {
      const dom = $('competitorTrendChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        const brands = Object.keys(competitorTrendSeries.visibility);
        const palette = ['#111827', '#d97706', '#2563eb', '#ec4899'];
        const series = [];
        brands.forEach((brand, index) => {
          series.push({
            name: `${brand} Â· å¯è§åº¦`,
            type: 'line',
            smooth: true,
            data: competitorTrendSeries.visibility[brand],
            lineStyle: { width: 2, color: palette[index] },
            symbol: 'circle',
            symbolSize: 4
          });
          series.push({
            name: `${brand} Â· AI æŒ‡æ•°`,
            type: 'line',
            smooth: true,
            yAxisIndex: 1,
            data: competitorTrendSeries.aiIndex[brand],
            lineStyle: { width: 2, color: palette[index], type: 'dashed' },
            symbol: 'circle',
            symbolSize: 4
          });
        });
        chart.setOption({
          tooltip: { trigger: 'axis' },
          legend: { type: 'scroll' },
          grid: { left: '6%', right: '6%', top: '18%', bottom: '14%' },
          xAxis: { type: 'category', data: competitorTrendSeries.months },
          yAxis: [
            { type: 'value', name: 'å¯è§åº¦', min: 30, max: 80, axisLabel: { formatter: '{value}%' } },
            { type: 'value', name: 'AI æŒ‡æ•°', min: 5.5, max: 8.5 }
          ],
          series
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] competitor trend error:', error);
        dom.innerHTML = '<div class="chart-fallback">è¶‹åŠ¿å¯¹æ¯”åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function buildMediaRiskTable() {
      const rows = mediaRiskRows
        .map(row => `
          <tr>
            <td>${row.platform}</td>
            <td>${row.status}</td>
            <td>${row.focus}</td>
            <td>${row.action}</td>
          </tr>`)
        .join('');
      return `
        <table class="data-table">
          <thead><tr><th>å¹³å°</th><th>é£é™©çŠ¶æ€</th><th>å…³æ³¨è®®é¢˜</th><th>ç­–ç•¥è¡ŒåŠ¨</th></tr></thead>
          <tbody>${rows}</tbody>
        </table>`;
    }

    function renderMediaHeatmap() {
      const dom = $('mediaHeatmapChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        const data = [];
        mediaHeatmapMatrix.data.forEach((row, rowIndex) => {
          row.forEach((value, colIndex) => {
            data.push([colIndex, rowIndex, value]);
          });
        });
        chart.setOption({
          tooltip: {
            formatter: ({ value }) => `${mediaHeatmapMatrix.platforms[value[1]]}<br/>${mediaHeatmapMatrix.metrics[value[0]]}ï¼š${value[2]}%`
          },
          grid: { left: '10%', right: '4%', top: '10%', bottom: '12%' },
          xAxis: {
            type: 'category',
            data: mediaHeatmapMatrix.metrics,
            axisLine: { lineStyle: { color: '#9ca3af' } }
          },
          yAxis: {
            type: 'category',
            data: mediaHeatmapMatrix.platforms,
            axisLine: { lineStyle: { color: '#9ca3af' } }
          },
          visualMap: {
            min: 0,
            max: 100,
            orient: 'horizontal',
            left: 'center',
            bottom: 0,
            inRange: { color: ['#fef3c7', '#fbbf24', '#111827'] }
          },
          series: [{
            type: 'heatmap',
            data,
            label: { show: true, color: '#111827', formatter: '{c}%'}
          }]
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] media heatmap error:', error);
        dom.innerHTML = '<div class="chart-fallback">åª’ä½“çƒ­åŠ›å›¾åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function renderMediaEffectChart() {
      const dom = $('mediaEffectChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        chart.setOption({
          tooltip: {
            formatter: params => {
              const [effect, risk, inclusion] = params.value;
              return `${params.name}<br/>åª’ä½“æ•ˆæœï¼š${effect}<br/>é£æ§å¾—åˆ†ï¼š${risk}<br/>æ”¶å½•ç‡ï¼š${inclusion}%`;
            }
          },
          grid: { left: '8%', right: '8%', top: '10%', bottom: '12%' },
          xAxis: {
            type: 'value',
            name: 'åª’ä½“æ•ˆæœ',
            min: 40,
            max: 100,
            splitLine: { lineStyle: { type: 'dashed' } }
          },
          yAxis: {
            type: 'value',
            name: 'é£æ§çŠ¶æ€',
            min: 40,
            max: 100,
            splitLine: { lineStyle: { type: 'dashed' } }
          },
          series: [{
            type: 'scatter',
            symbolSize: val => Math.sqrt(val[2]) * 5,
            data: mediaEffectScatter,
            label: { show: true, position: 'top' },
            itemStyle: {
              color: param => {
                const score = param.value[1];
                if (score >= 85) return '#0f766e';
                if (score >= 70) return '#d97706';
                return '#b91c1c';
              }
            }
          }]
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] media effect chart error:', error);
        dom.innerHTML = '<div class="chart-fallback">æ•ˆæœçŸ©é˜µåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function buildContentDistributionCards() {
      return `<div class="content-grid">${contentDistributions.map(block => `
        <div class="content-card">
          <header><span>${block.brand}</span><span>å†…å®¹å æ¯”</span></header>
          ${block.types.map(item => `
            <div class="content-item">
              <div class="content-meta"><span>${item.label}</span><span>${item.value}%</span></div>
              <div class="content-bar"><span style="width:${item.value}%"></span></div>
            </div>`).join('')}
          </div>
      `).join('')}</div>`;
    }

    function buildContentPerformanceTable() {
      const brands = Object.keys(contentPerformanceMetrics[0].data);
      const header = `<thead><tr><th>æŒ‡æ ‡</th>${brands.map(brand => `<th>${brand}</th>`).join('')}</tr></thead>`;
      const body = contentPerformanceMetrics
        .map(row => `<tr><td>${row.metric}</td>${brands.map(brand => `<td>${row.data[brand]}</td>`).join('')}</tr>`)
        .join('');
      return `<table class="data-table">${header}<tbody>${body}</tbody></table>`;
    }

    function buildContentTopicList() {
      return `<div class="content-grid">${contentTopicHighlights.map(block => `
        <div class="content-card">
          <header><span>${block.brand}</span><span>çƒ­è®®è¯é¢˜</span></header>
          <ul style="margin:0; padding-left:18px; font-size:12.5px; color:var(--text-secondary); line-height:1.7;">
            ${block.topics.map(topic => `<li>${topic}</li>`).join('')}
            </ul>
          </div>
      `).join('')}</div>`;
    }

    function renderBrandTab() {
      const metricCards = [
        buildMetricCard('å“ç‰Œå¯è§åº¦', `${metricsData.visibility}%`, metricTrends.visibility, 'è¡Œä¸šåŸºå‡† 55%'),
        buildMetricCard('AI è®¤çŸ¥æŒ‡æ•°', `${metricsData.aiIndex}/10`, metricTrends.aiIndex, 'è¡Œä¸šåŸºå‡† 6.2'),
        buildMetricCard('å“ç‰Œæ’åæŒ‡æ•°', `ç¬¬${metricsData.rank}å`, metricTrends.rank, 'å…± 8 ä¸ªç«å“'),
        buildMetricCard('æ­£æ–‡å¼•ç”¨ç‡', `${metricsData.textCitation}%`, metricTrends.textCitation, 'è¡Œä¸šåŸºå‡† 10%'),
        buildMetricCard('æ”¶å½•ç‡', `${metricsData.inclusion}%`, metricTrends.inclusion, 'è¡Œä¸šåŸºå‡† 15%'),
        buildMetricCard('AI è®¤çŸ¥ä»½é¢æŒ‡æ•°', `${metricsData.share}`, metricTrends.share, 'ç›¸å¯¹å‡è¡¡'),
        buildMetricCard('æƒ…æ„Ÿåº¦', `${metricsData.sentiment}%`, metricTrends.sentiment, 'è¡Œä¸šåŸºå‡† 70%'),
        buildMetricCard('é£é™©çŠ¶æ€', metricsData.risk, metricTrends.risk, 'è´Ÿé¢æƒ…ç»ªï¼šé‡ç‚¹ç›‘æµ‹')
      ].join('');

      const keywordDesignHTML = Object.entries(keywordDesign)
        .map(([title, items]) => `
          <div class="keyword-line">
            <span class="keyword-label">${title}ï¼š</span>
            <span class="keyword-value">${items.join(' Â· ')}</span>
          </div>`)
        .join('');

      const socialHTML = socialQuestions
        .map(group => `
          <div class="question-card">
            <h4>${group.platform}</h4>
            <ul>${group.items.map(item => `<li><a href="${item.url}" target="_blank" rel="noopener noreferrer">${item.title}</a><span class="badge">${item.badge}</span></li>`).join('')}</ul>
          </div>`)
        .join('');

      const aiHighHTML = aiHighFrequency.map(item => `<li><span>${item.text}</span><span class="badge" style="background:rgba(17,24,39,0.08); color:var(--accent-dark);">${item.badge}</span></li>`).join('');
      const aiDeepHTML = aiDeepQuestions.map(item => `<li><span>${item.text}</span><span class="badge" style="background:rgba(17,24,39,0.08); color:var(--accent-dark);">${item.badge}</span></li>`).join('');

      $('tab-brand').innerHTML = `
          <div class="glass-card">
          <h3>ğŸ“Š å¥åº·åº¦æ€»è§ˆ</h3>
          <div class="health-grid">
            <div class="health-left">
              <p>${analysisResult.summary}</p>
              <div class="health-metrics">${metricCards}</div>
          </div>
            <div class="health-right">
              <div id="brandRadarChart" class="chart-container"></div>
              <p class="radar-legend">ğŸ”µ èŠ±è¥¿å­å½“å‰è¡¨ç° Â· ğŸ¢ƒ è¡Œä¸šä¼˜ç§€åŸºå‡† Â· ğŸŸ¡ è¡Œä¸šå¹³å‡åŸºå‡†</p>
          </div>
          </div>
          </div>
            <div class="glass-card">
          <h3>ğŸ“Š åˆ†æ¨¡å‹è¡¨ç°</h3>
          <p style="margin:0 0 14px; font-size:13px; color:var(--text-secondary);"><span class="badge" style="margin-right:8px;">æƒé‡é€»è¾‘</span>ç»“åˆå“ç‰Œç›®æ ‡ç”¨æˆ·æ¨¡å‹ä½¿ç”¨é¢‘æ¬¡ä¸å†…å®¹æ²‰æ·€æ·±åº¦ï¼Œè¾“å‡ºå¤šç»´æ¨¡å‹ä¼˜å…ˆçº§å‚è€ƒã€‚</p>
          <div id="modelPerformance" class="question-row"></div>
          </div>
          <div class="glass-card">
          <h3>ğŸ” é«˜é¢‘é—®é¢˜åˆ†æ</h3>
          <div class="methodology-line"><span class="analysis-badge">åˆ†ææ–¹æ³•è®º</span><span>åŸºäºç”¨æˆ·å†³ç­–è·¯å¾„çš„å…¨ç½‘æ•°æ®é‡‡é›†ä¸ NLP åˆ†æï¼Œé¢„æµ‹ AI é«˜é¢‘ä¸æ·±åº¦é—®é¢˜ã€‚å‘¨åº¦æ›´æ–°ï¼Œå­£åº¦ä¼˜åŒ–ã€‚</span></div>
          <div class="keyword-cloud-grid">
            <div class="keyword-design-card">
              <h4>å…³é”®è¯è®¾è®¡ç­–ç•¥</h4>
              ${keywordDesignHTML}
          </div>
            <div class="question-card">
              <h4>é—®é¢˜è¯äº‘</h4>
              <div id="questionWordCloud" class="chart-container" style="height:260px;"></div>
          </div>
          </div>
          <h4 class="subheading">å‚è€ƒé—®é¢˜</h4>
          <div class="question-row social-row">${socialHTML}</div>
          <div class="question-row">
            <div class="question-card">
              <h4>ğŸ¤– AI é¢„æµ‹é«˜é¢‘é—®é¢˜</h4>
              <ul>${aiHighHTML}</ul>
            </div>
            <div class="question-card">
              <h4>ğŸ¤– AI é¢„æµ‹æ·±åº¦é—®é¢˜</h4>
              <ul>${aiDeepHTML}</ul>
          </div>
          </div>
        </div>
        <div class="glass-card">
          <h3>ğŸ¯ æˆ˜ç•¥æ´å¯Ÿ</h3>
          ${buildStrategicTable()}
        </div>`;

      renderBrandRadar();
      renderQuestionWordCloud();
      renderModelPerformanceCards();
    }

    function renderBrandRadar() {
      const dom = $('brandRadarChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        chart.setOption({
          tooltip: { trigger: 'item' },
          legend: { show: false },
          radar: {
            indicator: [
              { name: 'å“ç‰Œå¯è§åº¦', max: 80 },
              { name: 'æ­£æ–‡å¼•ç”¨ç‡', max: 22 },
              { name: 'AI è®¤çŸ¥æŒ‡æ•°', max: 8 },
              { name: 'æƒ…æ„Ÿåº¦', max: 85 },
              { name: 'æ”¶å½•ç‡', max: 25 }
            ],
            center: ['50%', '52%'],
            radius: '70%',
            splitNumber: 5,
            splitLine: { lineStyle: { color: ['rgba(17,24,39,0.14)'] } },
            splitArea: {
              show: true,
              areaStyle: { color: ['rgba(17,24,39,0.03)', 'rgba(212,175,55,0.05)'] }
            },
            axisLine: { lineStyle: { color: 'rgba(17,24,39,0.18)' } },
            nameGap: 6,
            name: {
              color: '#111827',
              fontSize: 12,
              backgroundColor: 'rgba(255,255,255,0.9)',
              padding: [3, 8],
              borderRadius: 10
            }
          },
          series: [{
            type: 'radar',
            lineStyle: { width: 2 },
            symbol: 'circle',
            symbolSize: 4,
            data: [
              {
                name: 'èŠ±è¥¿å­å½“å‰è¡¨ç°',
                value: [metricsData.visibility, metricsData.textCitation, metricsData.aiIndex, metricsData.sentiment, metricsData.inclusion],
                areaStyle: { color: 'rgba(37,99,235,0.22)' },
                lineStyle: { color: '#2563eb' },
                itemStyle: { color: '#2563eb' }
              },
              {
                name: 'è¡Œä¸šä¼˜ç§€åŸºå‡†',
                value: [70, 18, 8, 85, 25],
                areaStyle: { color: 'rgba(34,197,94,0.18)' },
                lineStyle: { color: '#16a34a' },
                itemStyle: { color: '#16a34a' }
              },
              {
                name: 'è¡Œä¸šå¹³å‡åŸºå‡†',
                value: [55, 10, 6.2, 70, 15],
                areaStyle: { color: 'rgba(245,158,11,0.18)' },
                lineStyle: { color: '#f59e0b' },
                itemStyle: { color: '#f59e0b' }
              }
            ]
          }]
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] brand radar error:', error);
        dom.innerHTML = '<div class="chart-fallback">é›·è¾¾å›¾åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function buildCompetitorOverviewCards() {
      return `<div class="overview-grid">${competitorOverview.map(item => `
        <div class="overview-card${item.highlight ? ' primary' : ''}">
          <div class="overview-header">
            <div class="brand-tag">${item.highlight ? `<span class="badge">${item.highlight}</span>` : ''}<span>${item.name}</span></div>
            <div class="brand-logo">${item.logo ? `<img src="${item.logo}" alt="${item.name}" />` : `<span>${item.name.slice(0,2)}</span>`}</div>
          </div>
          <p class="brand-meta" style="margin:0 0 4px;"><strong>ç­›é€‰é€»è¾‘ï¼š</strong>${item.filters}</p>
          <p class="brand-meta" style="margin:0;"><strong>æ´å¯Ÿï¼š</strong>${item.insight}</p>
          </div>
      `).join('')}</div>`;
    }

    function buildModelOperationTable() {
      return `<div id="modelOperationChart" class="chart-container" style="height:360px;"></div>`;
    }

    function buildRiskMatrixTable() {
      const rows = competitorRiskMatrix
        .map(row => `
          <tr>
            <th>${row.dimension}</th>
            <td>${row.florasis}</td>
            <td>${row.perfect}</td>
            <td>${row.colorkey}</td>
            <td>${row.intoYou}</td>
          </tr>`)
        .join('');
      return `<table class="data-table heatmap-table"><thead><tr><th>é£é™©ç»´åº¦</th><th>èŠ±è¥¿å­</th><th>å®Œç¾æ—¥è®°</th><th>Colorkey</th><th>into you</th></tr></thead><tbody>${rows}</tbody></table>`;
    }

    function buildCompetitorInsightBoard() {
      return `
        <div class="insight-board">
          <div class="insight-block">
            <h4>é˜µè¥åˆ†å±‚</h4>
            <ul class="insight-list">${competitorInsights.clusters.map(item => `<li>${item}</li>`).join('')}</ul>
            <h4>æœºä¼šè¯†åˆ«</h4>
            <ul class="insight-list">${competitorInsights.opportunities.map(item => `<li>${item}</li>`).join('')}</ul>
          </div>
          <div class="insight-block">
            <h4>ç«äº‰æ€§åª’ä½“ç­–ç•¥</h4>
            <ul class="insight-list">${competitorInsights.tactics.map(item => `<li>${item}</li>`).join('')}</ul>
            <h4>ç«äº‰é˜²å¾¡è¦ç‚¹</h4>
            <ul class="insight-list">${competitorInsights.defenses.map(item => `<li>${item}</li>`).join('')}</ul>
          </div>
        </div>`;
    }

    function buildMediaTopTable() {
      const rows = mediaTopCoverage
        .map(item => `
          <tr>
            <td>${item.rank}</td>
            <td>${item.media}</td>
            <td>${item.florasis}</td>
            <td>${item.perfect}</td>
            <td>${item.colorkey}</td>
            <td>${item.intoYou}</td>
            <td>${item.note}</td>
          </tr>`)
        .join('');
      return `<table class="media-table"><thead><tr><th>#</th><th>åª’ä½“</th><th>èŠ±è¥¿å­</th><th>å®Œç¾æ—¥è®°</th><th>Colorkey</th><th>into you</th><th>å·®è·åˆ†æ</th></tr></thead><tbody>${rows}</tbody></table>`;
    }

    function buildMediaRecommendationColumns() {
      return `
        <div class="media-dual">
          <div class="insight-block" style="gap:10px;">
            <h4>é£é™©é˜²æ§ç­–ç•¥</h4>
            <ul class="insight-list">${mediaRecommendations.risk.map(item => `<li>${item}</li>`).join('')}</ul>
            </div>
          <div class="insight-block" style="gap:10px;">
            <h4>æ•ˆæœæå‡ç­–ç•¥</h4>
            <ul class="insight-list">${mediaRecommendations.growth.map(item => `<li>${item}</li>`).join('')}</ul>
            </div>
        </div>`;
    }

    function buildStrategyMetricCards() {
      return `<div class="content-metric-grid">${strategyMetrics.map(item => `
        <div class="content-metric-card">
          <strong>${item.label}</strong>
          <span>${item.value}</span>
            </div>
      `).join('')}</div>`;
    }

    function buildStrategyTimeline() {
      return `<div class="timeline-wrapper">${strategyTimeline.map(item => `
        <div class="timeline-row">
          <div class="timeline-meta"><span>${item.phase}</span><span>${item.task}</span></div>
          <div class="timeline-bar"><span style="width:${item.progress}%"></span></div>
          </div>
      `).join('')}</div>`;
    }

    function buildPlatformStrategyCards() {
      return `<div class="platform-grid">${platformStrategies.map(card => `
        <div class="platform-card">
          <h4>${card.name}</h4>
          <span style="font-size:12px; color:var(--text-secondary);">${card.weight}</span>
          <ul>${card.goals.map(goal => `<li>${goal}</li>`).join('')}</ul>
                  </div>
      `).join('')}</div>`;
    }

    function buildGuidelineCards() {
      return `<div class="guideline-grid">${contentGuidelines.map(card => `
        <div class="guideline-card">
          <h4>${card.title}</h4>
          <ul>${card.items.map(item => `<li>${item}</li>`).join('')}</ul>
        </div>
      `).join('')}</div>`;
    }

    function renderMediaDistributionChart() {
      const dom = $('mediaDistributionChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        const series = mediaTypeDistribution.categories.map((category, idx) => ({
          name: category,
          type: 'bar',
          stack: 'total',
          emphasis: { focus: 'series' },
          itemStyle: { borderRadius: idx === mediaTypeDistribution.categories.length - 1 ? [0, 6, 6, 0] : 0 },
          data: mediaTypeDistribution.values.map(row => row[idx])
        }));
        chart.setOption({
          tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
          legend: {},
          grid: { left: '6%', right: '6%', top: '12%', bottom: '10%' },
          xAxis: { type: 'value', max: 100, axisLabel: { formatter: '{value}%' } },
          yAxis: { type: 'category', data: mediaTypeDistribution.brands },
          series
        });
        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] media distribution error:', error);
        dom.innerHTML = '<div class="chart-fallback">åª’ä½“åˆ†å¸ƒå›¾åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }

    function renderCompetitorTab() {
      const container = $('tab-competitor');
      if (!container) return;
        container.innerHTML = `
        <div class="tab-section">
          <div class="glass-card">
            <h3>ğŸ ç«å“æ¦‚è§ˆ</h3>
            ${buildCompetitorOverviewCards()}
            </div>
          <div class="glass-card">
            <h3>ğŸ“Š æ ¸å¿ƒæŒ‡æ ‡</h3>
            <div class="core-grid">
              <div class="core-summary">
                <p>${competitorCoreSummary}</p>
                ${buildCompetitorSummaryTable()}
            </div>
              <div>
                <div id="competitorRadarChart" class="chart-container"></div>
                <p class="radar-legend">ğŸ”µ èŠ±è¥¿å­ Â· ğŸŸ¢ å®Œç¾æ—¥è®° Â· ğŸŸ¡ Colorkey Â· ğŸŸ£ into you</p>
              </div>
              </div>
            </div>
          <div class="glass-card">
            <h3>ğŸ” æ¨¡å‹è¿è¥</h3>
            <p style="margin:0 0 12px; font-size:12.5px; color:var(--text-secondary);">æ°”æ³¡è¶Šå¤§ä»£è¡¨æ¨¡å‹å†…å®¹è¿è¥è¶Šæ·±å…¥ï¼Œå¯åˆ¤æ–­å“ç‰Œåœ¨ä¸åŒæ¨¡å‹ä¸Šçš„æŒæ§å¼ºåº¦ã€‚</p>
            <div id="modelOperationChart" class="chart-container" style="height:360px;"></div>
          </div>
          <div class="glass-card">
            <h3>ğŸ“ˆ è¶‹åŠ¿å¯¹æ¯”</h3>
            <p style="margin:0 0 12px; font-size:12.5px; color:var(--text-secondary);">è¿½è¸ªå“ç‰Œå¯è§åº¦ä¸ AI è®¤çŸ¥æŒ‡æ•°åœ¨ä¸åŒæ—¶é—´ã€ä¸åŒæ¨¡å‹ä¸­çš„è¡¨ç°å˜åŒ–ï¼Œæ”¯æŒå¿«é€Ÿåˆ‡æ¢è§†è§’ã€‚</p>
            <div id="competitorTrendChart" class="chart-container"></div>
          </div>
          <div class="glass-card">
            <h3>âš ï¸ é£é™©é¢„è­¦çŸ©é˜µ</h3>
            ${buildRiskMatrixTable()}
          </div>
          <div class="glass-card">
            <h3>ğŸ§­ ç«äº‰æ´å¯Ÿ</h3>
            ${buildCompetitorInsightBoard()}
          </div>
        </div>`;
      renderCompetitorRadarChart();
      renderModelOperationChart();
      renderCompetitorTrendChart();
    }

    function renderMediaTab() {
      const container = $('tab-media');
      if (!container) return;
      container.innerHTML = `
        <div class="tab-section media-grid">
          <div class="glass-card">
            <h3>ğŸ“Š åª’ä½“ç±»å‹åˆ†å¸ƒå¯¹æ¯”</h3>
            <div id="mediaDistributionChart" class="chart-container"></div>
          </div>
          <div class="glass-card">
            <h3>ğŸ¯ ç»†åˆ†åª’ä½“è¦†ç›– TOP5</h3>
            ${buildMediaTopTable()}
          </div>
          <div class="glass-card">
            <h3>ğŸ¯ åª’ä½“æƒ…æ„Ÿåˆ†å¸ƒçƒ­åŠ›å›¾</h3>
            <div id="mediaHeatmapChart" class="chart-container"></div>
          </div>
          <div class="glass-card">
            <h3>ğŸ“ˆ åª’ä½“æ•ˆæœä¸é£æ§çŸ©é˜µ</h3>
            <div id="mediaEffectChart" class="chart-container"></div>
          </div>
          <div class="glass-card">
            <h3>ğŸ›¡ï¸ åª’ä½“ç­–ç•¥ä¼˜åŒ–å»ºè®®</h3>
            ${buildMediaRecommendationColumns()}
          </div>
          <div class="glass-card">
            <h3>âš ï¸ é£æ§ç›‘æµ‹é‡ç‚¹</h3>
            ${buildMediaRiskTable()}
          </div>
        </div>`;
      renderMediaDistributionChart();
      renderMediaHeatmap();
          renderMediaEffectChart();
    }

    function renderContentTab() {
      const container = $('tab-content');
      if (!container) return;
        container.innerHTML = `
        <div class="tab-section">
          <div class="glass-card">
            <h3>ğŸ¯ ç­–ç•¥æ¦‚è§ˆ</h3>
            ${buildStrategyMetricCards()}
          </div>
          <div class="glass-card">
            <h3>ğŸ“… ç­–ç•¥æ—¶é—´è½´</h3>
            ${buildStrategyTimeline()}
          </div>
          <div class="glass-card">
            <h3>ğŸª å¹³å°ç­–ç•¥è®¡åˆ’</h3>
            ${buildPlatformStrategyCards()}
          </div>
          <div class="glass-card">
            <h3>ğŸ“ å†…å®¹ç±»å‹åˆ†å¸ƒ</h3>
            ${buildContentDistributionCards()}
            </div>
          <div class="glass-card">
            <h3>ğŸ“Š å†…å®¹è¡¨ç°å¯¹æ¯”</h3>
            ${buildContentPerformanceTable()}
          </div>
          <div class="glass-card">
            <h3>ğŸ”¥ çƒ­é—¨è¯é¢˜å¯¹æ¯”</h3>
            ${buildContentTopicList()}
          </div>
          <div class="glass-card">
            <h3>ğŸ”§ å†…å®¹ç”Ÿäº§æ ‡å‡†</h3>
            ${buildGuidelineCards()}
          </div>
        </div>`;
    }

    function safeExecute(fn, onError) {
      try {
        fn();
      } catch (error) {
        console.error('[GEO] render error:', error);
        if (typeof onError === 'function') onError(error);
      }
    }

    const tabFallbacks = {
      brand: (error) => {
        const el = $('tab-brand');
        if (el) el.innerHTML = `<div class="glass-card"><h3>ğŸ“Š å“ç‰Œè¯Šæ–­åŠ è½½å¤±è´¥</h3><p style="margin:0; color:var(--text-secondary);">${error?.message || 'è¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚'}</p></div>`;
      },
      competitor: (error) => {
        const el = $('tab-competitor');
        if (el) el.innerHTML = `<div class="glass-card"><h3>ğŸ†š ç«å“å¯¹æ¯”åŠ è½½å¤±è´¥</h3><p style="margin:0; color:var(--text-secondary);">${error?.message || 'è¯·åˆ·æ–°é¡µé¢æˆ–ç¨åå†è¯•ã€‚'}</p></div>`;
      },
      media: (error) => {
        const el = $('tab-media');
        if (el) el.innerHTML = `<div class="glass-card"><h3>ğŸ¯ åª’ä½“åˆ†å¸ƒåŠ è½½å¤±è´¥</h3><p style="margin:0; color:var(--text-secondary);">${error?.message || 'è¯·åˆ·æ–°é¡µé¢æˆ–ç¨åå†è¯•ã€‚'}</p></div>`;
      },
      content: (error) => {
        const el = $('tab-content');
        if (el) el.innerHTML = `<div class="glass-card"><h3>ğŸ§­ å†…å®¹ç­–ç•¥åŠ è½½å¤±è´¥</h3><p style="margin:0; color:var(--text-secondary);">${error?.message || 'è¯·åˆ·æ–°é¡µé¢æˆ–ç¨åå†è¯•ã€‚'}</p></div>`;
      }
    };

    const tabRenderers = {
      brand: renderBrandTab,
      competitor: renderCompetitorTab,
      media: renderMediaTab,
      content: renderContentTab
    };

    const tabRendered = {
      brand: false,
      competitor: false,
      media: false,
      content: false
    };

    function renderTabs() {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const target = btn.dataset.tab;
          ['brand', 'competitor', 'media', 'content'].forEach(key => {
            const el = document.getElementById(`tab-${key}`);
            if (el) el.style.display = key === target ? 'block' : 'none';
          });
          if (!tabRendered[target] && tabRenderers[target]) {
            safeExecute(() => {
              tabRenderers[target]();
              tabRendered[target] = true;
              window.dispatchEvent(new Event('resize'));
            }, tabFallbacks[target]);
          } else {
            window.dispatchEvent(new Event('resize'));
          }
        });
      });
    }

    function initPage() {
      safeExecute(() => renderFormSection('step1Form', 'user'));
      safeExecute(() => renderFormSection('step2Form', 'ai'));
      safeExecute(renderStep2DeepDirection);
      safeExecute(renderGlobalModelFilters);
      safeExecute(() => {
        renderBrandTab();
        tabRendered.brand = true;
      }, tabFallbacks.brand);
      safeExecute(() => {
        renderCompetitorTab();
        tabRendered.competitor = true;
      }, tabFallbacks.competitor);
      safeExecute(() => {
        renderMediaTab();
        tabRendered.media = true;
      }, tabFallbacks.media);
      safeExecute(() => {
        renderContentTab();
        tabRendered.content = true;
      }, tabFallbacks.content);
      renderTabs();
    }

    document.addEventListener('DOMContentLoaded', initPage);

    function renderModelOperationChart() {
      const dom = $('modelOperationChart');
      if (!dom) return;
      try {
        const chart = echarts.init(dom);
        const models = modelOperationHeatmap.map(item => item.model);
        const brandKeys = [
          { key: 'florasis', label: 'èŠ±è¥¿å­' },
          { key: 'perfect', label: 'å®Œç¾æ—¥è®°' },
          { key: 'colorkey', label: 'Colorkey' },
          { key: 'intoYou', label: 'into you' }
        ];

        const levelMeta = level => {
          const raw = String(level || '').replace(/^[^\u4e00-\u9fa5a-zA-Z0-9]+/, '').trim();
          if (raw.includes('ä¼˜ç§€')) return { text: 'ä¼˜ç§€', key: 'excellent', sizeBase: 46 };
          if (raw.includes('å¾…æ”¹å–„')) return { text: 'å¾…æ”¹å–„', key: 'improve', sizeBase: 28 };
          return { text: 'è‰¯å¥½', key: 'good', sizeBase: 36 };
        };

        const calcSize = (score, sizeBase) => {
          const clamped = Math.min(Math.max(score, 0), 10);
          return Math.round(sizeBase + clamped * 1.8);
        };

        const bubbleData = [];

        const applyLogoSymbol = dataPoint => {
          const { brand, logoUrl } = dataPoint;
          if (!logoUrl) {
            dataPoint.symbol = 'circle';
            dataPoint.itemStyle = { color: '#e5e7eb', borderWidth: 0 };
            return;
          }
          if (logoSymbolCache[logoUrl]) {
            dataPoint.symbol = `image://${logoSymbolCache[logoUrl]}`;
            return;
          }
          const img = new Image();
          img.crossOrigin = 'anonymous';
          img.src = logoUrl;
          img.onload = () => {
            try {
              const canvas = document.createElement('canvas');
              const size = 128;
              canvas.width = size;
              canvas.height = size;
              const ctx = canvas.getContext('2d');
              ctx.clearRect(0, 0, size, size);
              ctx.beginPath();
              ctx.arc(size / 2, size / 2, size / 2, 0, Math.PI * 2);
              ctx.closePath();
              ctx.clip();
              ctx.drawImage(img, 0, 0, size, size);
              const dataUrl = canvas.toDataURL('image/png');
              if (dataUrl) {
                logoSymbolCache[logoUrl] = dataUrl;
                dataPoint.symbol = `image://${dataUrl}`;
                chart.setOption({
                  series: [{ id: 'model-operation', data: bubbleData }]
                });
              }
            } catch (err) {
              console.error('[GEO] logo render error:', err);
            }
          };
          img.onerror = () => {
            dataPoint.symbol = 'circle';
            dataPoint.itemStyle = { color: '#e5e7eb', borderWidth: 0 };
          };
          dataPoint.symbol = 'circle';
          dataPoint.itemStyle = { color: '#e5e7eb', borderWidth: 0 };
        };

        modelOperationHeatmap.forEach(row => {
          brandKeys.forEach(({ key, label }) => {
            const entry = row[key];
            if (!entry) return;
            const score = Number(entry.score) || 0;
            const meta = levelMeta(entry.level);
            const logo = brandLogoMap[label] || '';
            const dataPoint = {
              value: [row.model, label, score],
              brand: label,
              model: row.model,
              levelText: meta.text,
              levelKey: meta.key,
              symbolSize: calcSize(score, meta.sizeBase),
              logoUrl: logo
            };
            applyLogoSymbol(dataPoint);
            bubbleData.push(dataPoint);
          });
        });

        chart.setOption({
          tooltip: {
            backgroundColor: 'rgba(17, 24, 39, 0.9)',
            borderWidth: 0,
            textStyle: { color: '#f9fafb', fontSize: 12 },
            formatter: params => {
              const data = params.data || {};
              return `${data.brand || ''} Â· ${data.model || ''}<br/>è¿è¥è¯„ä»·ï¼š${data.levelText || 'â€”'}`;
            }
          },
          grid: { left: '8%', right: '8%', top: '12%', bottom: '12%' },
          xAxis: {
            type: 'category',
            data: models,
            axisTick: { show: false },
            axisLine: { lineStyle: { color: 'rgba(17,24,39,0.18)' } },
            axisLabel: { color: '#4b5563' }
          },
          yAxis: {
            type: 'category',
            data: brandKeys.map(item => item.label),
            axisTick: { show: false },
            axisLine: { lineStyle: { color: 'rgba(17,24,39,0.18)' } },
            axisLabel: { color: '#4b5563' }
          },
          series: [{
            id: 'model-operation',
            type: 'scatter',
            data: bubbleData,
            encode: { x: 0, y: 1, value: 2 },
            symbolKeepAspect: true,
            symbolSize: params => params.data?.symbolSize || 32,
            itemStyle: {
              borderWidth: 0,
              shadowBlur: 10,
              shadowColor: 'rgba(17,24,39,0.16)'
            },
            emphasis: { scale: 1.05 },
            label: {
              show: true,
              position: 'right',
              fontSize: 12,
              fontWeight: 600,
              formatter: params => {
                const key = params.data?.levelKey || 'good';
                const text = params.data?.levelText || '';
                return `{${key}|${text}}`;
              },
              rich: {
                excellent: { color: '#16a34a' },
                good: { color: '#eab308' },
                improve: { color: '#dc2626' }
              }
            }
          }]
        });

        window.addEventListener('resize', () => chart.resize());
      } catch (error) {
        console.error('[GEO] model operation chart error:', error);
        dom.innerHTML = '<div class="chart-fallback">æ¨¡å‹è¿è¥å›¾åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
      }
    }
  </script>
</body>
</html>

